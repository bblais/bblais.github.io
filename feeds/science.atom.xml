<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>bblais on the web - science</title><link href="https://bblais.github.io/" rel="alternate"/><link href="https://bblais.github.io/feeds/science.atom.xml" rel="self"/><id>https://bblais.github.io/</id><updated>2024-11-04T00:00:00-05:00</updated><entry><title>Energy Balance Revisited</title><link href="https://bblais.github.io/posts/2024/Nov/04/energy-balance-revisited/" rel="alternate"/><published>2024-11-04T00:00:00-05:00</published><updated>2024-11-04T00:00:00-05:00</updated><author><name>Brian Blais</name></author><id>tag:bblais.github.io,2024-11-04:/posts/2024/Nov/04/energy-balance-revisited/</id><summary type="html">&lt;p&gt;Going back a few years I published an article simplifying the calculations for atmospheric greenhouse gas effects for undergraduate non-science majors,&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href="https://iopscience.iop.org/article/10.1088/0031-9120/38/6/004/meta" rel="nofollow"&gt;Blais, B. (2003). Teaching energy balance using round numbers …&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;</summary><content type="html">&lt;p&gt;Going back a few years I published an article simplifying the calculations for atmospheric greenhouse gas effects for undergraduate non-science majors,&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href="https://iopscience.iop.org/article/10.1088/0031-9120/38/6/004/meta" rel="nofollow"&gt;Blais, B. (2003). Teaching energy balance using round numbers. &lt;em&gt;Physics education&lt;/em&gt;, &lt;em&gt;38&lt;/em&gt;(6), 519.&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;I recently came across another article which does a similar thing, but using slightly different notation and terminology,&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href="https://pubs.aip.org/aapt/pte/article/51/3/152/276578" rel="nofollow"&gt;LoPresto, M. C. (2013). Adding albedo and atmospheres. &lt;em&gt;The Physics Teacher&lt;/em&gt;, &lt;em&gt;51&lt;/em&gt;(3), 152-153.&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;In the spirit of reproducibility I wanted to see if I could connect LoPresto's results with mine. &lt;/p&gt;
&lt;h2 id="round-number-method"&gt;Round Number Method&lt;/h2&gt;
&lt;p&gt;In my method, the amount of energy entering the Earth system is the round number &lt;span class="math"&gt;\(S=100/r^2\)&lt;/span&gt; where &lt;span class="math"&gt;\(r\)&lt;/span&gt; is the distance from the sun in astronomical units (AU).  In these units, &lt;span class="math"&gt;\(r=1\)&lt;/span&gt; for the Earth.  The temperature of the surface, or any atmospheric layer, is related to the energy output of that layer, derived to be 
&lt;/p&gt;
&lt;div class="math"&gt;$$
\begin{equation}
\left(\frac{T}{88.5 \text{K}}\right)^4 = E
\end{equation}
$$&lt;/div&gt;
&lt;p&gt;
We look at a simple 1-layer model, where the short-wavelength albedo is &lt;span class="math"&gt;\(a\)&lt;/span&gt; and the atmosphere absorbs some fraction, &lt;span class="math"&gt;\(\gamma\)&lt;/span&gt;, of the long-wavelength radiation.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Energy Balance.drawio.svg" src="https://bblais.github.io/images/Energy Balance.drawio.svg"&gt;&lt;/p&gt;
&lt;p&gt;we get energy balance equations of&lt;/p&gt;
&lt;div class="math"&gt;$$
\begin{aligned}
+(1-a)\cdot S -E_s + E_1 &amp;amp;=0 \\
+\gamma E_s - E_1 - E_1 &amp;amp;=0
\end{aligned}
$$&lt;/div&gt;
&lt;p&gt;which leads to solutions for the energy emitted from the surface and the layer 1, as well as the corresponding temperatures,&lt;/p&gt;
&lt;div class="math"&gt;$$
\begin{aligned}
E_1&amp;amp;=\frac{\gamma S \cdot (1-a)}{2-\gamma} \\
E_s&amp;amp;=\frac{2E_1}{\gamma}=\frac{2 S \cdot (1-a)}{2-\gamma}\\
T_1&amp;amp;=88.5\text{ K}\cdot \left(\frac{\gamma S \cdot (1-a)}{2-\gamma}\right)^{1/4} \\
T_s&amp;amp;=88.5\text{ K}\cdot \left(\frac{2 S \cdot (1-a)}{2-\gamma}\right)^{1/4} = T_1 \cdot 2^{1/4}\cdot (2-\gamma)^{-1/4}
\end{aligned}
$$&lt;/div&gt;
&lt;p&gt;We can check a few extreme cases, like &lt;span class="math"&gt;\(\gamma=0\)&lt;/span&gt; (no atmosphere),
&lt;/p&gt;
&lt;div class="math"&gt;$$
\begin{aligned}
E_1&amp;amp;=0 \\
E_s&amp;amp;=S \cdot (1-a) \\
T_s&amp;amp;=88.5\text{ K}\cdot \left(S \cdot (1-a)\right)^{1/4}
\end{aligned}
$$&lt;/div&gt;
&lt;p&gt;
and an infrared-opaque atmosphere, &lt;span class="math"&gt;\(\gamma=1\)&lt;/span&gt;,&lt;/p&gt;
&lt;div class="math"&gt;$$
\begin{aligned}
E_1&amp;amp;=S \cdot (1-a) \\
E_s&amp;amp;=2 S \cdot (1-a)\\
T_1&amp;amp;=88.5\text{ K}\cdot \left(S \cdot (1-a)\right)^{1/4} \\
T_s&amp;amp;=88.5\text{ K}\cdot \left(2S \cdot (1-a)\right)^{1/4} \\
\end{aligned}
$$&lt;/div&gt;
&lt;p&gt;
Using the numbers from &lt;a href="https://pubs.aip.org/aapt/pte/article/51/3/152/276578" rel="nofollow"&gt;LoPresto, M. C. (2013)&lt;/a&gt;, where the albedo (&lt;span class="math"&gt;\(a\)&lt;/span&gt;) is measured but the long-wavelength radiation fraction of absorption (&lt;span class="math"&gt;\(\gamma\)&lt;/span&gt;) is inferred^[LoPresto uses values for the properties of the atmosphere in their table, but admits there is a lot of variation.  I prefer to infer the values from the temperatures, and discuss whether it makes sense.], we get&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style="text-align: left;"&gt;&lt;/th&gt;
&lt;th style="text-align: right;"&gt;Albedo&lt;/th&gt;
&lt;th style="text-align: right;"&gt;T Obs. [K]&lt;/th&gt;
&lt;th style="text-align: right;"&gt;Distance from Sun [AU]&lt;/th&gt;
&lt;th style="text-align: right;"&gt;T (no atm) [K]&lt;/th&gt;
&lt;th style="text-align: right;"&gt;T (γ=0.3) [K]&lt;/th&gt;
&lt;th style="text-align: right;"&gt;γ (best fit)&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style="text-align: left;"&gt;Mercury&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.119&lt;/td&gt;
&lt;td style="text-align: right;"&gt;400&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.39&lt;/td&gt;
&lt;td style="text-align: right;"&gt;434.2&lt;/td&gt;
&lt;td style="text-align: right;"&gt;452.2&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.776&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left;"&gt;Venus&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.75&lt;/td&gt;
&lt;td style="text-align: right;"&gt;737&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.72&lt;/td&gt;
&lt;td style="text-align: right;"&gt;233.2&lt;/td&gt;
&lt;td style="text-align: right;"&gt;242.9&lt;/td&gt;
&lt;td style="text-align: right;"&gt;1.98&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left;"&gt;Earth&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.306&lt;/td&gt;
&lt;td style="text-align: right;"&gt;288&lt;/td&gt;
&lt;td style="text-align: right;"&gt;1&lt;/td&gt;
&lt;td style="text-align: right;"&gt;255.4&lt;/td&gt;
&lt;td style="text-align: right;"&gt;266&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.762&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left;"&gt;Mars&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.25&lt;/td&gt;
&lt;td style="text-align: right;"&gt;225&lt;/td&gt;
&lt;td style="text-align: right;"&gt;1.52&lt;/td&gt;
&lt;td style="text-align: right;"&gt;211.2&lt;/td&gt;
&lt;td style="text-align: right;"&gt;220&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.446&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left;"&gt;Jupiter&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.343&lt;/td&gt;
&lt;td style="text-align: right;"&gt;124&lt;/td&gt;
&lt;td style="text-align: right;"&gt;5.2&lt;/td&gt;
&lt;td style="text-align: right;"&gt;110.5&lt;/td&gt;
&lt;td style="text-align: right;"&gt;115.1&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.739&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left;"&gt;Saturn&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.342&lt;/td&gt;
&lt;td style="text-align: right;"&gt;97&lt;/td&gt;
&lt;td style="text-align: right;"&gt;9.58&lt;/td&gt;
&lt;td style="text-align: right;"&gt;81.4&lt;/td&gt;
&lt;td style="text-align: right;"&gt;84.8&lt;/td&gt;
&lt;td style="text-align: right;"&gt;1.006&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left;"&gt;Uranus&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.3&lt;/td&gt;
&lt;td style="text-align: right;"&gt;58&lt;/td&gt;
&lt;td style="text-align: right;"&gt;19.22&lt;/td&gt;
&lt;td style="text-align: right;"&gt;58.4&lt;/td&gt;
&lt;td style="text-align: right;"&gt;60.8&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.054&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left;"&gt;Neptune&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.29&lt;/td&gt;
&lt;td style="text-align: right;"&gt;59&lt;/td&gt;
&lt;td style="text-align: right;"&gt;30.07&lt;/td&gt;
&lt;td style="text-align: right;"&gt;46.8&lt;/td&gt;
&lt;td style="text-align: right;"&gt;48.8&lt;/td&gt;
&lt;td style="text-align: right;"&gt;1.205&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;There are several things to note here.   If we interpret &lt;span class="math"&gt;\(\gamma\)&lt;/span&gt; as the fraction absorbed, both &lt;span class="math"&gt;\(\gamma&amp;lt;0\)&lt;/span&gt; and &lt;span class="math"&gt;\(\gamma&amp;gt;1\)&lt;/span&gt; are physically impossible.  The former indicates that there is no atmosphere and we must be within uncertainties in the albedo or observed temperature.  The latter is something we can address, by modifying the model.  This is done by deriving the equations used in  &lt;a href="https://pubs.aip.org/aapt/pte/article/51/3/152/276578" rel="nofollow"&gt;LoPresto, M. C. (2013)&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id="adding-albedo-and-atmosphere"&gt;Adding Albedo and Atmosphere&lt;/h2&gt;
&lt;p&gt;From the paper,&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href="https://pubs.aip.org/aapt/pte/article/51/3/152/276578" rel="nofollow"&gt;LoPresto, M. C. (2013). Adding albedo and atmospheres. &lt;em&gt;The Physics Teacher&lt;/em&gt;, &lt;em&gt;51&lt;/em&gt;(3), 152-153.&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;we are given the result from a multi-layer model atmosphere.  Their result for the case without an atmosphere is
&lt;/p&gt;
&lt;div class="math"&gt;$$
T_e=(1-a)^{1/4}\left(\frac{279}{r^{1/2}}\right)\text{ K}
$$&lt;/div&gt;
&lt;p&gt;
which we call &lt;span class="math"&gt;\(T_e\)&lt;/span&gt; for effective radiative temperature.^[LoPresto calls it simply &lt;span class="math"&gt;\(T\)&lt;/span&gt; which we find unclear.]. This is the same as our &lt;span class="math"&gt;\(\gamma=0\)&lt;/span&gt; case,
&lt;/p&gt;
&lt;div class="math"&gt;$$
\begin{aligned}
T_s&amp;amp;=88.5\text{ K}\cdot \left(S \cdot (1-a)\right)^{1/4}\\
T_s&amp;amp;=88.5\text{ K}\cdot \left(\frac{100}{r^2} \cdot (1-a)\right)^{1/4}\\
&amp;amp;=279\text{ K} \cdot \frac{1}{r^{1/2}}\cdot \left(1-a\right)^{1/4}
\end{aligned}
$$&lt;/div&gt;
&lt;p&gt;
They then include a greenhouse, and derive the temperature to be
&lt;/p&gt;
&lt;div class="math"&gt;$$
T_g = 2^{1/4}\cdot T_e
$$&lt;/div&gt;
&lt;p&gt;
which is equivalent to our case above with &lt;span class="math"&gt;\(\gamma=1\)&lt;/span&gt;.  They then quote a result,
&lt;/p&gt;
&lt;div class="math"&gt;$$
T_g = (1+\tau)^{1/4}\cdot T_e
$$&lt;/div&gt;
&lt;p&gt;
without derivation, of which their previous result is a special case (&lt;span class="math"&gt;\(\tau=1\)&lt;/span&gt;).  The value &lt;span class="math"&gt;\(\tau\)&lt;/span&gt; is called the "total extinction thickness" and is the number of layers that completely absorb infrared radiation (i.e. long wavelength).  So there must be some connection between my &lt;span class="math"&gt;\(\gamma\)&lt;/span&gt; and their &lt;span class="math"&gt;\(\tau\)&lt;/span&gt;.  &lt;/p&gt;
&lt;h2 id="deriving-the-total-extinction-thickness-tau"&gt;Deriving the total extinction thickness, &lt;span class="math"&gt;\(\tau\)&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;To derive their result, we add more layers to the original model, and assume that every layer absorbs 100% of the radiation entering it from other layers.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Energy Balance2.drawio.svg" src="https://bblais.github.io/images/Energy Balance2.drawio.svg"&gt;&lt;/p&gt;
&lt;p&gt;The energy balance equations for &lt;span class="math"&gt;\(n\)&lt;/span&gt; such layers is,&lt;/p&gt;
&lt;div class="math"&gt;$$
\begin{aligned}
+(1-a)\cdot S -E_s + E_1 &amp;amp;=0 \\
+E_s - E_1 - E_1 + E_2&amp;amp;=0 \\
+E_1 - E_2 - E_2 + E_3&amp;amp;=0 \\
&amp;amp;\vdots\\
+E_{n-3} - E_{n-2} - E_{n-2} + E_{n-1}&amp;amp;=0 \\
+E_{n-2} - E_{n-1} - E_{n-1} + E_n&amp;amp;=0 \\
+E_{n-1} - E_{n} - E_{n}&amp;amp;=0
\end{aligned}
$$&lt;/div&gt;
&lt;p&gt;
You can confirm that this works for the &lt;span class="math"&gt;\(n=3\)&lt;/span&gt; model shown.  Notice that there is an asymmetry in the equations, with the surface-layer and the top-layer equations a little different from the others.&lt;/p&gt;
&lt;p&gt;Solving from the top layer (last equation) down to the surface we get
&lt;/p&gt;
&lt;div class="math"&gt;$$
\begin{aligned}
E_{n-1}&amp;amp;=2E_n \\
E_{n-2}&amp;amp;=2E_{n-1}-E_n = 3E_n \\
E_{n-3}&amp;amp;=2E_{n-2}-E_{n-1} = 4E_n \\
&amp;amp;\vdots\\
E_{2}&amp;amp;=(1+n-2)\cdot E_n\\
E_{1}&amp;amp;=(1+n-1)\cdot E_n\\
E_{s}&amp;amp;=(1+n)\cdot E_n
\end{aligned}
$$&lt;/div&gt;
&lt;p&gt;
From the first balance equation we 
&lt;/p&gt;
&lt;div class="math"&gt;$$
\begin{aligned}
+(1-a)\cdot S -E_s + E_1 &amp;amp;=0 \\
(1-a)\cdot S - (1+n)\cdot E_n + (1+n-1)\cdot E_n&amp;amp;=0 \\
(1-a)\cdot S-E_n&amp;amp;=0 \\
E_n&amp;amp;=(1-a)\cdot S
\end{aligned}
$$&lt;/div&gt;
&lt;p&gt;Our final result for the energy output of the surface in the multi-layer model is,&lt;/p&gt;
&lt;div class="math"&gt;$$
\begin{aligned}
E_{s}&amp;amp;=(1+n)\cdot (1-a)\cdot S \\
T_s &amp;amp;=88.5 \text{ K}\cdot (1+n)^{1/4}\cdot \left((1-a)\cdot S\right)^{1/4} \\
&amp;amp;=(1+n)^{1/4} \cdot T_e \\
&amp;amp;=(1+\tau)^{1/4} \cdot T_e \\
\end{aligned}
$$&lt;/div&gt;
&lt;p&gt;
Where the last step is the result from LoPresto, where it is clear that the number of layers, &lt;span class="math"&gt;\(n\)&lt;/span&gt;, is equivalent to their "total extinction thickness", &lt;span class="math"&gt;\(\tau\)&lt;/span&gt;.  &lt;/p&gt;
&lt;h2 id="connecting-our-gamma-to-loprestos-tau"&gt;Connecting our &lt;span class="math"&gt;\(\gamma\)&lt;/span&gt; to LoPresto's &lt;span class="math"&gt;\(\tau\)&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;Connecting my &lt;span class="math"&gt;\(\gamma\)&lt;/span&gt; to LoPresto's &lt;span class="math"&gt;\(\tau\)&lt;/span&gt; we get&lt;/p&gt;
&lt;div class="math"&gt;$$
\frac{2}{2-\gamma}=1+\tau
$$&lt;/div&gt;
&lt;p&gt;
or 
&lt;/p&gt;
&lt;div class="math"&gt;$$
\gamma=\frac{2\tau}{1+\tau}
$$&lt;/div&gt;
&lt;p&gt;
We can then reproduce the table above&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style="text-align: left;"&gt;&lt;/th&gt;
&lt;th style="text-align: right;"&gt;Albedo&lt;/th&gt;
&lt;th style="text-align: right;"&gt;T Obs. [K]&lt;/th&gt;
&lt;th style="text-align: right;"&gt;Distance from Sun [AU]&lt;/th&gt;
&lt;th style="text-align: right;"&gt;T (no atm) [K]&lt;/th&gt;
&lt;th style="text-align: right;"&gt;γ (best fit)&lt;/th&gt;
&lt;th style="text-align: right;"&gt;τ (best fit)&lt;/th&gt;
&lt;th style="text-align: right;"&gt;T (best fit)&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style="text-align: left;"&gt;Mercury&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.119&lt;/td&gt;
&lt;td style="text-align: right;"&gt;400&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.39&lt;/td&gt;
&lt;td style="text-align: right;"&gt;434.2&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.776&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.28&lt;/td&gt;
&lt;td style="text-align: right;"&gt;400&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left;"&gt;Venus&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.75&lt;/td&gt;
&lt;td style="text-align: right;"&gt;737&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.72&lt;/td&gt;
&lt;td style="text-align: right;"&gt;233.2&lt;/td&gt;
&lt;td style="text-align: right;"&gt;1.98&lt;/td&gt;
&lt;td style="text-align: right;"&gt;98.729&lt;/td&gt;
&lt;td style="text-align: right;"&gt;736.9&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left;"&gt;Earth&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.306&lt;/td&gt;
&lt;td style="text-align: right;"&gt;288&lt;/td&gt;
&lt;td style="text-align: right;"&gt;1&lt;/td&gt;
&lt;td style="text-align: right;"&gt;255.4&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.762&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.616&lt;/td&gt;
&lt;td style="text-align: right;"&gt;288&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left;"&gt;Mars&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.25&lt;/td&gt;
&lt;td style="text-align: right;"&gt;225&lt;/td&gt;
&lt;td style="text-align: right;"&gt;1.52&lt;/td&gt;
&lt;td style="text-align: right;"&gt;211.2&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.446&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.287&lt;/td&gt;
&lt;td style="text-align: right;"&gt;225&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left;"&gt;Jupiter&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.343&lt;/td&gt;
&lt;td style="text-align: right;"&gt;124&lt;/td&gt;
&lt;td style="text-align: right;"&gt;5.2&lt;/td&gt;
&lt;td style="text-align: right;"&gt;110.5&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.739&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.586&lt;/td&gt;
&lt;td style="text-align: right;"&gt;124&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left;"&gt;Saturn&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.342&lt;/td&gt;
&lt;td style="text-align: right;"&gt;97&lt;/td&gt;
&lt;td style="text-align: right;"&gt;9.58&lt;/td&gt;
&lt;td style="text-align: right;"&gt;81.4&lt;/td&gt;
&lt;td style="text-align: right;"&gt;1.006&lt;/td&gt;
&lt;td style="text-align: right;"&gt;1.013&lt;/td&gt;
&lt;td style="text-align: right;"&gt;97&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left;"&gt;Uranus&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.3&lt;/td&gt;
&lt;td style="text-align: right;"&gt;58&lt;/td&gt;
&lt;td style="text-align: right;"&gt;19.22&lt;/td&gt;
&lt;td style="text-align: right;"&gt;58.4&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.054&lt;/td&gt;
&lt;td style="text-align: right;"&gt;-0.026&lt;/td&gt;
&lt;td style="text-align: right;"&gt;58&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left;"&gt;Neptune&lt;/td&gt;
&lt;td style="text-align: right;"&gt;0.29&lt;/td&gt;
&lt;td style="text-align: right;"&gt;59&lt;/td&gt;
&lt;td style="text-align: right;"&gt;30.07&lt;/td&gt;
&lt;td style="text-align: right;"&gt;46.8&lt;/td&gt;
&lt;td style="text-align: right;"&gt;1.205&lt;/td&gt;
&lt;td style="text-align: right;"&gt;1.516&lt;/td&gt;
&lt;td style="text-align: right;"&gt;58.9&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;The interpretation of, say, Venus's &lt;span class="math"&gt;\(\tau=98\)&lt;/span&gt; (100 effective layers!) is much easier using this result rather than the physically unreasonable &lt;span class="math"&gt;\(\gamma=1.98\)&lt;/span&gt;.  In teaching this concept to students again, I may sketch the derivation, and then quote the result:&lt;/p&gt;
&lt;div class="math"&gt;$$
\begin{aligned}
E_{s}&amp;amp;=(1+n)\cdot (1-a)\cdot S
\end{aligned}
$$&lt;/div&gt;
&lt;p&gt;
which has a reasonably intuitive simple form.  I imagine there may be other useful comparisons to make.&lt;/p&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &amp;lt; 768) ? "left" : align;
        indent = (screen.width &amp;lt; 768) ? "0em" : indent;
        linebreak = (screen.width &amp;lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    &lt;a href="http://mathjaxscript.id" rel="nofollow"&gt;mathjaxscript.id&lt;/a&gt; = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '&lt;a href="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';" rel="nofollow"&gt;https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';&lt;/a&gt;

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content><category term="science"/></entry><entry><title>Leon Cooper passes away</title><link href="https://bblais.github.io/posts/2024/Oct/27/leon-cooper-passes-away/" rel="alternate"/><published>2024-10-27T00:00:00-04:00</published><updated>2024-10-27T00:00:00-04:00</updated><author><name>Brian Blais</name></author><id>tag:bblais.github.io,2024-10-27:/posts/2024/Oct/27/leon-cooper-passes-away/</id><summary type="html">&lt;p&gt;My mentor and friend Leon Cooper has died at the age of 94.  I am still grappling with this news, hitting me harder than I expected.  However, why wouldn't I …&lt;/p&gt;</summary><content type="html">&lt;p&gt;My mentor and friend Leon Cooper has died at the age of 94.  I am still grappling with this news, hitting me harder than I expected.  However, why wouldn't I expect to be shaken by this news?  &lt;/p&gt;
&lt;p&gt;I first met Leon Cooper at Brown University in 1994, me still a new graduate student in Physics in my second semester.  I had come to Brown to either study astrophysics or to study with Leon Cooper who was working on models of the brain.  He had won the Nobel Prize for his work on Superconductivity, and was working now on computational neuroscience -- a field that basically didn't exist when he started to work on it.  &lt;/p&gt;
&lt;p&gt;I was always interested in the "big questions" and both astrophysics and neuroscience spoke to these questions.  I interviewed with another graduate student in Leon Cooper's lab at the time, Mike Perrone, who put me on a project during my second semester  -- presumably to see if I could hack it in the lab.  I did contribute to his project, and presented my work at a conference.  Leon Cooper then offered me a summer stipend where I would work on understanding some of the recent work of Charles Law and Harel Shouval, who had been doing simulations of synaptic plasticity in the visual system.   That was 1994 -- 30 years ago.  This semester, now 2024, I submitted for a conference presentation using some of the same models I was introduced to in 1994.  This speaks to the strength of the BCM synaptic plasticity model (named after the 1982 authors Bienenstock, Cooper, and Munro) and to the influence Leon Cooper has had both in the field of neuroscience and my own professional life.&lt;/p&gt;
&lt;p&gt;The Brown University Physics Department had a "qualifying exam" the September of one's second year as a graduate student.  It consisted of a 2-day written exam followed by a possible oral exam.   If you scored above a 70 on the written exam, you'd pass outright.  If you got between a 60 and a 70 you'd have an oral exam.  Below a 60, you'd fail and have another chance six months later.  I got a 55 on the exam.  I was able to argue for 5 more points, due to questions being unclear or me approaching problems in a different way than expected.  After the new points, I had achieved a 60 on the qualifying exam -- the minimum for an oral exam.   A few days later, I have my oral exam with three professors, including Leon Cooper.  The stakes were whether I could stay at Brown University for physics.  I don't remember a lot about that exam, other than that it was one and a half hours, I blanked on some questions, and felt confident on others.  I distinctly recall Leon's questioning style -- one that I have adopted whenever I give oral exams.  He would ask a super-easy question, one where to get it wrong really should result in a failing grade.   Then he'd add a small complication, and ask a follow-up question.  After several of these step-ups, until you couldn't answer the question, he had a very good measure of what you knew while at the same time removing the effect of being nervous or blanking on a topic momentarily.  This process of starting easy, and moving up in small steps, was a brilliant measurement method for determining someone's aptitude in a topic.  It was one of many things that Leon did gently and brilliantly and that I have tried to emulate since.&lt;/p&gt;
&lt;p&gt;After the exam, I went up to the lab wondering if I would be able to stay, not at all confident in my performance.   I sat down, and wrote out one of the answers I had blanked on.  I still tell my students that I can more easily write things on paper than in front of a whiteboard.  Leon came up to tell me the result of the discussion, and he said that the consensus was that I was borderline and that if he decided to pass me, I'd be "his problem now", smiling and lightly laughing as he did when bemused.  He did pass me which has affected my entire life trajectory since.  &lt;/p&gt;
&lt;p&gt;In a letter I wrote for Leon's 80th birthday I told him  "although I know that I am, at best, a mediocre physicist you have always made me feel as if I were much better."  It was always clear that Leon Cooper had a way of looking at the world that was far deeper and clearer than anything I could approach.   In neuroscience seminars, I watched as he listened to a graduate student or postdoc present their research and then ask them such a penetrating question that they were taken aback.  He was able to slice through all of the complexities that biologists are trained to focus on and find a problem or solution about their research question that they had never considered.  It was a skill of making things as "simple as possible but no simpler", a la Einstein, and Leon had an ability to do this across the multiple disciplines of physics and biology that was worthy of two Nobel Prizes, in my opinion.  Yet, in our personal interactions, he never made me feel like I was in any way inferior to him. &lt;/p&gt;
&lt;p&gt;Some of my fondest memories are from our weekly meetings, which lasted until February 2020, stopping due to Covid.  Even when he wasn't as active in research, he was always interested to hear the latest work that I was doing.  Given my teaching and service obligations, my research has been somewhat glacial on certain topics, but Leon was always interested.  We spoke about the interpretation of quantum mechanics, a topic he loved and that I was also interested in but had far less aptitude than he.   We also had a shared interest in the methods of teaching different topics in physics.  I made an audiobook of the recordings of his class "Physics: Structure and Meaning".  Ironically, I hadn't listened to it in quite a while, but had picked it up this week again before I had heard the news of his passing.  I love Leon's approach to teaching of telling historical anecdotes, and leading the students through the thought process the scientists had as they developed the current theories.   He did this, rather than just provide them the answers, to give them a connection to the material that I don't think any textbook or YouTube video could rival.  Leon Cooper was the quintessential teacher, and was in a unique position to inform his teaching with his experience unraveling some of the fundamental mysteries in physics earning him his Nobel Prize.&lt;/p&gt;
&lt;p&gt;It is no exaggeration to say that Leon Cooper has been the most important person to my professional career, always supportive even when I knew that I was not performing up to the potential I could have.  I have always striven to be like him -- clear in his vision of how the universe works, passionate about teaching, always able to see through to the essential important issues whether that was in physics or biology, and gentle to the core.  I never heard him raise his voice in the 30 years I've known him, yet he was always clear in expressing when he disagreed with a point.  &lt;/p&gt;
&lt;p&gt;Like many things, our weekly meetings were disrupted by Covid and then Leon was ill for a while.  I met with him once at his house in 2021.  I regret not making it a priority to visit more often.  I wish I could have communicated to him how much he has meant top me, and still means to me and that so much of the way I think and work and appreciate this life comes from him.  I was already missing Leon, and knowing that I won't have any more discussions over coffee with him breaks my heart.  I will always be thankful for the happy accident that brought us together and for his wonderful presence in my life.  I will always remember him, and with the wonders of modern technology, I get to hear his teaching voice anytime I want to.&lt;/p&gt;
&lt;p&gt;I will always remember Leon and the influence he had in my life.  With Leon Cooper, thus passes one of the most amazing humans that has ever lived, and I have been blessed to have crossed part of his path on my own journey, for which I am eternally thankful.  Farewell Leon.&lt;/p&gt;</content><category term="science"/></entry><entry><title>One Rule to Rule Them All</title><link href="https://bblais.github.io/posts/2022/Nov/08/one-rule-to-rule-them-all/" rel="alternate"/><published>2022-11-08T00:00:00-05:00</published><updated>2022-11-08T00:00:00-05:00</updated><author><name>Brian Blais</name></author><id>tag:bblais.github.io,2022-11-08:/posts/2022/Nov/08/one-rule-to-rule-them-all/</id><summary type="html">&lt;p&gt;I'm giving a talk at the Fall Cross-Disciplinary Research, Teaching and Technology Symposium on Wednesday November 9th, 2:00PM – 5:00PM at Bryant University.  The theme this semester is Bayesian …&lt;/p&gt;</summary><content type="html">&lt;p&gt;I'm giving a talk at the Fall Cross-Disciplinary Research, Teaching and Technology Symposium on Wednesday November 9th, 2:00PM – 5:00PM at Bryant University.  The theme this semester is Bayesian Methods, so I get to opine about all thing Bayes!  &lt;/p&gt;
&lt;p&gt;&lt;a href="https://bblais.github.io/images/One Rule to Rule Them All.pdf" rel="nofollow"&gt;Here are my slides.&lt;/a&gt;&lt;/p&gt;</content><category term="science"/><category term="statistics"/><category term="bayesian"/></entry><entry><title>Why do we need double-blind studies?</title><link href="https://bblais.github.io/posts/2022/May/31/why-do-we-need-double-blind-studies/" rel="alternate"/><published>2022-05-31T00:00:00-04:00</published><updated>2022-05-31T00:00:00-04:00</updated><author><name>Brian Blais</name></author><id>tag:bblais.github.io,2022-05-31:/posts/2022/May/31/why-do-we-need-double-blind-studies/</id><summary type="html">&lt;p&gt;I was recently reading some articles about &lt;a href="https://bblais.github.io/posts/2020/Jul/09/skepticism-and-dubious-medical-procedures/" rel="nofollow"&gt;dubious medical procedures&lt;/a&gt;, and the claims of miraculous healings.  I was struck by a level of credulity with some of these claims, but …&lt;/p&gt;</summary><content type="html">&lt;p&gt;I was recently reading some articles about &lt;a href="https://bblais.github.io/posts/2020/Jul/09/skepticism-and-dubious-medical-procedures/" rel="nofollow"&gt;dubious medical procedures&lt;/a&gt;, and the claims of miraculous healings.  I was struck by a level of credulity with some of these claims, but at the same time felt the emotional tug of a healing claim and some internal push-back on the insistence on double-blind studies.  I can understand how the people making the claim might balk at skepticism.  Why do we always need double-blind studies in medicine anyway?  Can't you do a procedure, especially if there is an obvious positive outcome (e.g. someone can walk who couldn't before, see when they were blind before, etc...), and see the outcome and not have to go through all of the hassle of making a double-blind study?&lt;/p&gt;
&lt;p&gt;Not being a medical doctor, I started to read about it.  I've learned a few interesting examples that I read &lt;a href="https://www.winchesterhospital.org/health-library/article?id=38405&amp;amp;utm_source=pocket_mylist" rel="nofollow"&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;One about the effectiveness of a surgical procedure:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;For a particularly dramatic example of this phenomenon, consider what happened when orthopedic surgeon Bruce Moseley, team physician for the Houston Rockets, decided he needed to properly evaluate the efficacy of an operation commonly used to treat the pain caused by arthritic knees. This surgery involves scraping away rough areas in the knee's cartilage. It is widely believed to be effective, and as many as 400,000 such surgeries are performed each year.&lt;/p&gt;
&lt;p&gt;Mosely decided to see if the surgery really worked. He conducted a study in which five patients were given the real surgery and five were given fake surgery consisting of little incisions over the knee. He then followed his patients for two years.&lt;/p&gt;
&lt;p&gt;The results were amazing. Interviews showed that pain and swelling were reduced just as much in the placebo group as in the group that received the real surgery. Four out of the five participants who experienced the fake surgery said it was so helpful they'd gladly recommend it to a friend. Glowing testimonials, in other words, mean nothing.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;(the study is &lt;a href="https://pubmed.ncbi.nlm.nih.gov/12110735/" rel="nofollow"&gt;here&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;Another &lt;a href="https://bjui-journals.onlinelibrary.wiley.com/doi/abs/10.1046/j.1464-410x.1998.00554.x" rel="nofollow"&gt;about prostate size&lt;/a&gt; (placebo gave the same improvements even after 2 years).&lt;/p&gt;
&lt;p&gt;So how does this happen?  The article points out (with references) common examples which include:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;a href="https://en.wikipedia.org/wiki/Observer_bias" rel="nofollow"&gt;Observer bias&lt;/a&gt;&lt;/strong&gt; -- the person doing the measurement inadvertently noticing where the effect is, or not, because they expect it&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;a href="https://en.wikipedia.org/wiki/Pygmalion_effect" rel="nofollow"&gt;Rosenthal Effect&lt;/a&gt;&lt;/strong&gt; (aka the &lt;strong&gt;&lt;a href="https://en.wikipedia.org/wiki/Observer-expectancy_effect" rel="nofollow"&gt;observer-expectancy effect&lt;/a&gt;&lt;/strong&gt;)-- the observer inadvertently influencing the participants actions, so they act in the way the observer expects.  this indirect communication can be remarkably subtle and effective.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Reinterpretation Effect&lt;/strong&gt; - when observers reinterpret the result after the fact, given the expectations.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Placebo Effect&lt;/strong&gt; - when no-treatment gives a positive result.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Memory Distortion&lt;/strong&gt; - the observer's memory of results changes over time&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Natural Course of the Disease: Illusion of Agency&lt;/strong&gt; - natural improvements can possible lead to misattributing the treatment effectiveness&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Study Drop Outs&lt;/strong&gt; - participants with bad results may drop out of a study, leaving the good results remaining&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;To this list I'd add&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Multiple treatments&lt;/strong&gt; -- if a participant gets multiple treatments simultaneously, the observer could misattribute the effectiveness of one of the treatments. &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Each of these problems are clearly possible with any of the miraculous healing claims &lt;a href="https://bblais.github.io/posts/2022/Mar/23/a-long-discussion-about-miracles/" rel="nofollow"&gt;I've read about and reviewed earlier&lt;/a&gt;.  In the presence of a community supporting faith-healings, you get observer bias, Rothenthal effects,  the illusion of agency, and placebo effects occuring.  When the reports come some time after the events, the memory distortion, reinterpretation effects, and multiple treatment effects.  Further, faith-healings have a massive drop-out problem -- many people are prayed for, and the people who don't get healed don't step forward.&lt;/p&gt;
&lt;p&gt;How do you make sure that the treatment you are studying actually works?  You have to rule out each of these effects:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;keep all of the participants (rules put drop-out effects)&lt;/li&gt;
&lt;li&gt;keep accurate pre-post observations (rules out reinterpretation and memory distortion effects)&lt;/li&gt;
&lt;li&gt;use placebo control groups (rules out natural course)&lt;/li&gt;
&lt;li&gt;keep all parties blind to the treatment and placebo groups (rules out observer and Rosenthal effects)&lt;/li&gt;
&lt;li&gt;keep all treatments narrow and quantitative (rules out multiple treatment and memory distortion) &lt;/li&gt;
&lt;/ul&gt;</content><category term="science"/></entry><entry><title>Chemical Reaction Dynamics</title><link href="https://bblais.github.io/posts/2022/Jan/14/chemical-reaction-dynamics/" rel="alternate"/><published>2022-01-14T00:00:00-05:00</published><updated>2022-01-14T00:00:00-05:00</updated><author><name>Brian Blais</name></author><id>tag:bblais.github.io,2022-01-14:/posts/2022/Jan/14/chemical-reaction-dynamics/</id><summary type="html">&lt;p&gt;As an exercise, I like to reproduce computational papers, but with my own tools.  This let's me know that I understand completely what is being  written and in many cases …&lt;/p&gt;</summary><content type="html">&lt;p&gt;As an exercise, I like to reproduce computational papers, but with my own tools.  This let's me know that I understand completely what is being  written and in many cases allows me to extend and debug my own tools.  I'm going to do a series of these as I work through some of my reading list.  The first one I'm doing is available here:&lt;/p&gt;
&lt;p&gt;&lt;a href="https://www.cs.princeton.edu/picasso/mats/matlab/princeton_spring06.pdf" rel="nofollow"&gt;https://www.cs.princeton.edu/picasso/mats/matlab/princeton_spring06.pdf&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;In this case, not only was I able to reproduce the results of the text, but it uncovered two bugs in my &lt;a href="https://bblais.github.io/pyndamics3/" rel="nofollow"&gt;&lt;code&gt;pyndamics3&lt;/code&gt;&lt;/a&gt; package which I was able to fix.  &lt;/p&gt;
&lt;p&gt;The main system in the text being solved is&lt;/p&gt;
&lt;p&gt;&lt;img alt="Pasted image 20220113102335.png" src="https://bblais.github.io/images/Pasted image 20220113102335.png"&gt;&lt;/p&gt;
&lt;div class="highlight" style="background: #202020"&gt;&lt;pre style="line-height: 125%;"&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span style="color: #D0D0D0"&gt;%pylab&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;inline&lt;/span&gt;

&lt;span style="color: #6EBF26; font-weight: bold"&gt;from&lt;/span&gt;&lt;span style="color: #666"&gt; &lt;/span&gt;&lt;span style="color: #71ADFF; text-decoration: underline"&gt;pyndamics3&lt;/span&gt;&lt;span style="color: #666"&gt; &lt;/span&gt;&lt;span style="color: #6EBF26; font-weight: bold"&gt;import&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;Simulation&lt;/span&gt;
&lt;span style="color: #6EBF26; font-weight: bold"&gt;from&lt;/span&gt;&lt;span style="color: #666"&gt; &lt;/span&gt;&lt;span style="color: #71ADFF; text-decoration: underline"&gt;pyndamics3.chem&lt;/span&gt;&lt;span style="color: #666"&gt; &lt;/span&gt;&lt;span style="color: #6EBF26; font-weight: bold"&gt;import&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;ChemSimulation&lt;/span&gt;

&lt;span style="color: #D0D0D0"&gt;b=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;20&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;k3=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0.00577&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;k4=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0.0001925&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;k1=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;.01&lt;/span&gt;

&lt;span style="color: #D0D0D0"&gt;sim=ChemSimulation(&lt;/span&gt;
&lt;span style="color: #ED9D13"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span style="color: #ED9D13"&gt;D --k1--&amp;gt; D+M&lt;/span&gt;
&lt;span style="color: #ED9D13"&gt;M --k2--&amp;gt; M+P&lt;/span&gt;
&lt;span style="color: #ED9D13"&gt;M --k3--&amp;gt; ϕ&lt;/span&gt;
&lt;span style="color: #ED9D13"&gt;P --k4--&amp;gt; ϕ&lt;/span&gt;
&lt;span style="color: #ED9D13"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,D=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,M=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,ϕ=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,P=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,k1=k1,k2=b*k3,k3=k3,k4=k4)&lt;/span&gt;

&lt;span style="color: #6EBF26; font-weight: bold"&gt;for&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;c&lt;/span&gt; &lt;span style="color: #6EBF26; font-weight: bold"&gt;in&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;sim.components:&lt;/span&gt;
    &lt;span style="color: #D0D0D0"&gt;c.plot=&lt;/span&gt;&lt;span style="color: #6EBF26; font-weight: bold"&gt;True&lt;/span&gt;

&lt;span style="color: #D0D0D0"&gt;sim.run(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;4e4&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Output:&lt;/p&gt;
&lt;div class="highlight" style="background: #202020"&gt;&lt;pre style="line-height: 125%;"&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span style="color: #6EBF26; font-weight: bold"&gt;[&amp;#39;D&amp;#39;] k1 [&amp;#39;D&amp;#39;, &amp;#39;M&amp;#39;]&lt;/span&gt;
&lt;span style="color: #6EBF26; font-weight: bold"&gt;[&amp;#39;M&amp;#39;] k2 [&amp;#39;M&amp;#39;, &amp;#39;P&amp;#39;]&lt;/span&gt;
&lt;span style="color: #6EBF26; font-weight: bold"&gt;[&amp;#39;M&amp;#39;] k3 [&amp;#39;ϕ&amp;#39;]&lt;/span&gt;
&lt;span style="color: #6EBF26; font-weight: bold"&gt;[&amp;#39;P&amp;#39;] k4 [&amp;#39;ϕ&amp;#39;]&lt;/span&gt;
&lt;span style="color: #BBB"&gt;Components [&amp;#39;D&amp;#39;, &amp;#39;M&amp;#39;, &amp;#39;P&amp;#39;, &amp;#39;ϕ&amp;#39;]&lt;/span&gt;
&lt;span style="color: #BBB"&gt;Parameters [&amp;#39;k1&amp;#39;, &amp;#39;k2&amp;#39;, &amp;#39;k3&amp;#39;, &amp;#39;k4&amp;#39;]&lt;/span&gt;
&lt;span style="color: #BBB"&gt;diffeqs [&amp;quot;D&amp;#39;&lt;/span&gt;&lt;span style="color: #666"&gt; &lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;=&lt;/span&gt;&lt;span style="color: #666"&gt; &lt;/span&gt;&lt;span style="color: #ED9D13"&gt;0&amp;quot;, &amp;quot;M&amp;#39; =  +k1*D -k3*M&amp;quot;, &amp;quot;P&amp;#39; =  +k2*M -k4*P&amp;quot;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;which yields figures like:&lt;/p&gt;
&lt;p&gt;&lt;img alt="Pasted image 20220113102516.png" src="https://bblais.github.io/images/Pasted image 20220113102516.png"&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="Pasted image 20220113102541.png" src="https://bblais.github.io/images/Pasted image 20220113102541.png"&gt;
&lt;img alt="Pasted image 20220113102550.png" src="https://bblais.github.io/images/Pasted image 20220113102550.png"&gt;&lt;/p&gt;
&lt;p&gt;The text points out,&lt;/p&gt;
&lt;p&gt;&lt;img alt="Pasted image 20220113102608.png" src="https://bblais.github.io/images/Pasted image 20220113102608.png"&gt;&lt;/p&gt;
&lt;p&gt;which we can find by looking at the end of the array for each of those variables.&lt;/p&gt;
&lt;div class="highlight" style="background: #202020"&gt;&lt;pre style="line-height: 125%;"&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span style="color: #D0D0D0"&gt;sim.P[-&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;],sim.M[-&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight" style="background: #202020"&gt;&lt;pre style="line-height: 125%;"&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;(1038.4743123361338, 1.7331022510164473)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The paper then adds the exercise&lt;/p&gt;
&lt;p&gt;&lt;img alt="Pasted image 20220113102710.png" src="https://bblais.github.io/images/Pasted image 20220113102710.png"&gt;&lt;/p&gt;
&lt;div class="highlight" style="background: #202020"&gt;&lt;pre style="line-height: 125%;"&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span style="color: #D0D0D0"&gt;b=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;k3=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0.00577&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;k4=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0.0001925&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;k1=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;.01&lt;/span&gt;

&lt;span style="color: #D0D0D0"&gt;sim=ChemSimulation(&lt;/span&gt;
&lt;span style="color: #ED9D13"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span style="color: #ED9D13"&gt;D --k1--&amp;gt; D+M&lt;/span&gt;
&lt;span style="color: #ED9D13"&gt;M --k2--&amp;gt; M+P&lt;/span&gt;
&lt;span style="color: #ED9D13"&gt;M --k3--&amp;gt; ϕ&lt;/span&gt;
&lt;span style="color: #ED9D13"&gt;P --k4--&amp;gt; ϕ&lt;/span&gt;
&lt;span style="color: #ED9D13"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,D=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,M=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,ϕ=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,P=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,k1=k1,k2=b*k3,k3=k3,k4=k4)&lt;/span&gt;


&lt;span style="color: #6EBF26; font-weight: bold"&gt;for&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;c&lt;/span&gt; &lt;span style="color: #6EBF26; font-weight: bold"&gt;in&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;sim.components:&lt;/span&gt;
    &lt;span style="color: #D0D0D0"&gt;c.plot=&lt;/span&gt;&lt;span style="color: #6EBF26; font-weight: bold"&gt;True&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;I discovered that by originally doing&lt;/p&gt;
&lt;div class="highlight" style="background: #202020"&gt;&lt;pre style="line-height: 125%;"&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span style="color: #D0D0D0"&gt;sim.run(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1e4&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;

&lt;span style="color: #D0D0D0"&gt;sim.P[-&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;],sim.M[-&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;]&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight" style="background: #202020"&gt;&lt;pre style="line-height: 125%;"&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;(88.21709421325941, 1.7331022259104094)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;it didn't match the fixed point stated in the text!  So Iooked at the plot&lt;/p&gt;
&lt;p&gt;&lt;img alt="Pasted image 20220113103003.png" src="https://bblais.github.io/images/Pasted image 20220113103003.png"&gt;&lt;/p&gt;
&lt;p&gt;and saw it hadn't converged.  Increasing the run time&lt;/p&gt;
&lt;div class="highlight" style="background: #202020"&gt;&lt;pre style="line-height: 125%;"&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span style="color: #D0D0D0"&gt;sim.run(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1e5&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;

&lt;span style="color: #D0D0D0"&gt;sim.P[-&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;],sim.M[-&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight" style="background: #202020"&gt;&lt;pre style="line-height: 125%;"&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;(103.8961031134814, 1.7331022530369293)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img alt="Pasted image 20220113103146.png" src="https://bblais.github.io/images/Pasted image 20220113103146.png"&gt;&lt;/p&gt;
&lt;p&gt;It converged and we got the same answer as in the text.&lt;/p&gt;
&lt;p&gt;Another time I will extend this to the stochastic version, which is in the second part of the text.&lt;/p&gt;</content><category term="science"/></entry><entry><title>Simulating Stochastic Processes</title><link href="https://bblais.github.io/posts/2022/Jan/07/simulating-stochastic-processes/" rel="alternate"/><published>2022-01-07T00:00:00-05:00</published><updated>2022-01-07T00:00:00-05:00</updated><author><name>Brian Blais</name></author><id>tag:bblais.github.io,2022-01-07:/posts/2022/Jan/07/simulating-stochastic-processes/</id><summary type="html">&lt;p&gt;In this post we are going to explore the simulation of stochastic (i.e. random) processes, and work our way to understanding how the Gillespie algorithm works.  We'll be using …&lt;/p&gt;</summary><content type="html">&lt;p&gt;In this post we are going to explore the simulation of stochastic (i.e. random) processes, and work our way to understanding how the Gillespie algorithm works.  We'll be using mostly straightforward Python, except for my &lt;code&gt;Storage&lt;/code&gt; class from &lt;a href="https://bblais.github.io/posts/2020/Feb/24/common-python-pattern-building-up-lists-to-plot/" rel="nofollow"&gt;https://bblais.github.io/posts/2020/Feb/24/common-python-pattern-building-up-lists-to-plot/&lt;/a&gt; and some default plotting preferences specified in &lt;a href="https://raw.githubusercontent.com/bblais/Python-for-Science/master/science/science.mplstyle" rel="nofollow"&gt;https://raw.githubusercontent.com/bblais/Python-for-Science/master/science/science.mplstyle&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id="imports"&gt;Imports&lt;/h2&gt;
&lt;div class="highlight" style="background: #202020"&gt;&lt;pre style="line-height: 125%;"&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span style="color: #D0D0D0"&gt;%pylab&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;inline&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;style.use(&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;science.mplstyle&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #6EBF26; font-weight: bold"&gt;from&lt;/span&gt;&lt;span style="color: #666"&gt; &lt;/span&gt;&lt;span style="color: #71ADFF; text-decoration: underline"&gt;Memory&lt;/span&gt;&lt;span style="color: #666"&gt; &lt;/span&gt;&lt;span style="color: #6EBF26; font-weight: bold"&gt;import&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;Storage&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id="a-simple-problem"&gt;A simple problem&lt;/h2&gt;
&lt;p&gt;In this first problem, we have a process that occurs with probability &lt;span class="math"&gt;\(p=0.02\)&lt;/span&gt; per second.  When an event happens, the number &lt;span class="math"&gt;\(n\)&lt;/span&gt; is incremented by 1.  The average linear rate of increase will be the same as &lt;span class="math"&gt;\(p\)&lt;/span&gt;.&lt;/p&gt;
&lt;div class="highlight" style="background: #202020"&gt;&lt;pre style="line-height: 125%;"&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span style="color: #D0D0D0"&gt;number_of_simulations=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;20&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;dt=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1.0&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;p=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0.02&lt;/span&gt;
&lt;span style="color: #6EBF26; font-weight: bold"&gt;for&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;_&lt;/span&gt; &lt;span style="color: #6EBF26; font-weight: bold"&gt;in&lt;/span&gt; &lt;span style="color: #2FBCCD"&gt;range&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;(number_of_simulations):&lt;/span&gt;
    &lt;span style="color: #D0D0D0"&gt;S=Storage()&lt;/span&gt;
    &lt;span style="color: #D0D0D0"&gt;t=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0&lt;/span&gt;
    &lt;span style="color: #D0D0D0"&gt;n=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0&lt;/span&gt;
    &lt;span style="color: #D0D0D0"&gt;S+=t,n&lt;/span&gt;
    &lt;span style="color: #6EBF26; font-weight: bold"&gt;while&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;t&amp;lt;&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1000&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;:&lt;/span&gt;
        &lt;span style="color: #6EBF26; font-weight: bold"&gt;if&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;rand()&amp;lt;p*dt:&lt;/span&gt;
            &lt;span style="color: #D0D0D0"&gt;n+=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;

        &lt;span style="color: #D0D0D0"&gt;t+=dt&lt;/span&gt;

        &lt;span style="color: #D0D0D0"&gt;S+=t,n&lt;/span&gt;

    &lt;span style="color: #D0D0D0"&gt;t,n=S.arrays()&lt;/span&gt;
    &lt;span style="color: #D0D0D0"&gt;plot(t,n,&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;b-o&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,alpha=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0.01&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;


&lt;span style="color: #D0D0D0"&gt;plot(t,p*t,&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;r-&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;


&lt;span style="color: #D0D0D0"&gt;ylabel(&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;$n$&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;xlabel(&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;$t$&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img alt="output_6_1.png" src="https://bblais.github.io/images/output_6_1.png"&gt;&lt;/p&gt;
&lt;p&gt;To motivate the faster algorithm, let's run a bunch of simulations, and record the time to the first event only.  Then count up how many events happen at the various times.  &lt;/p&gt;
&lt;div class="highlight" style="background: #202020"&gt;&lt;pre style="line-height: 125%;"&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span style="color: #D0D0D0"&gt;S=Storage()&lt;/span&gt;

&lt;span style="color: #D0D0D0"&gt;N=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;50000&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;p=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0.03&lt;/span&gt;
&lt;span style="color: #6EBF26; font-weight: bold"&gt;for&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;_&lt;/span&gt; &lt;span style="color: #6EBF26; font-weight: bold"&gt;in&lt;/span&gt; &lt;span style="color: #2FBCCD"&gt;range&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;(N):&lt;/span&gt;

    &lt;span style="color: #D0D0D0"&gt;t=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0&lt;/span&gt;
    &lt;span style="color: #6EBF26; font-weight: bold"&gt;while&lt;/span&gt; &lt;span style="color: #6EBF26; font-weight: bold"&gt;True&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;:&lt;/span&gt;
        &lt;span style="color: #6EBF26; font-weight: bold"&gt;if&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;rand()&amp;lt;p:&lt;/span&gt;
            &lt;span style="color: #6EBF26; font-weight: bold"&gt;break&lt;/span&gt;

        &lt;span style="color: #D0D0D0"&gt;t+=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;

    &lt;span style="color: #D0D0D0"&gt;S+=t,&lt;/span&gt;

&lt;span style="color: #D0D0D0"&gt;t=S.arrays()&lt;/span&gt;

&lt;span style="color: #D0D0D0"&gt;n,tn,h=hist(t,&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;200&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;);&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;xlabel(&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;time to first event&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;ylabel(&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;number of events&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;


&lt;span style="color: #D0D0D0"&gt;slope,intercept=polyfit(tn[:&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;100&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;],log(n[:&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;100&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;]),&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;plot(tn[:&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;100&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;],exp(slope*tn[:&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;100&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;]+intercept),&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;r-&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;

&lt;span style="color: #D0D0D0"&gt;λ=p&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;plot(tn,exp(-λ*tn)*n[&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;],&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;k--&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,lw=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;5&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img alt="Pasted image 20220106220712.png" src="https://bblais.github.io/images/Pasted image 20220106220712.png"&gt;&lt;/p&gt;
&lt;p&gt;which looks exponential, so we compare it to an exponentiial fit (linear fit to the log) and an exponential with a decay factor &lt;span class="math"&gt;\(\lambda=p\)&lt;/span&gt;.  The fit is quite good!&lt;/p&gt;
&lt;p&gt;To normalize analytically (and make it a proper probability function), we need to make sure that the integral over &lt;span class="math"&gt;\(t\)&lt;/span&gt;  is 1,&lt;/p&gt;
&lt;div class="math"&gt;$$
\begin{aligned}
p(t)&amp;amp;= p_o e^{-\lambda t}\\
\int_0^{+\infty} p_o e^{-\lambda t} dt &amp;amp;=1 \\
\left.\left(\frac{1}{-\lambda}\right)p_o e^{-\lambda t}\right|^{+\infty}_{0} &amp;amp;=1 \\
0 - \left(\frac{1}{-\lambda}\right)p_o &amp;amp;=1 \\
p_o &amp;amp;=\lambda
\end{aligned}
$$&lt;/div&gt;
&lt;p&gt;
therefore the distribution is &lt;/p&gt;
&lt;div class="math"&gt;$$
p(t) = \lambda e^{-\lambda t}
$$&lt;/div&gt;
&lt;p&gt;
which can be seen here &lt;a href="https://en.wikipedia.org/wiki/Exponential_distribution" rel="nofollow"&gt;https://en.wikipedia.org/wiki/Exponential_distribution&lt;/a&gt;&lt;/p&gt;
&lt;h2 id="towards-gillespie"&gt;Towards Gillespie&lt;/h2&gt;
&lt;p&gt;Instead of flipping the coin every millisecond (i.e. constant time), we can randomly pick a &lt;em&gt;time&lt;/em&gt; from an exponential distribution -- the time to the next event (i.e. dynamic time).&lt;/p&gt;
&lt;div class="highlight" style="background: #202020"&gt;&lt;pre style="line-height: 125%;"&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span style="color: #6EBF26; font-weight: bold"&gt;def&lt;/span&gt;&lt;span style="color: #666"&gt; &lt;/span&gt;&lt;span style="color: #71ADFF"&gt;constant_time&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;(N=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;20&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,n0=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,t_max=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1000&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,p=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0.02&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,dt=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;):&lt;/span&gt;
    &lt;span style="color: #D0D0D0"&gt;S_mat=[]&lt;/span&gt;
    &lt;span style="color: #6EBF26; font-weight: bold"&gt;for&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;_&lt;/span&gt; &lt;span style="color: #6EBF26; font-weight: bold"&gt;in&lt;/span&gt; &lt;span style="color: #2FBCCD"&gt;range&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;(N):&lt;/span&gt;
        &lt;span style="color: #D0D0D0"&gt;S=Storage()&lt;/span&gt;
        &lt;span style="color: #D0D0D0"&gt;t=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0&lt;/span&gt;
        &lt;span style="color: #D0D0D0"&gt;n=n0&lt;/span&gt;
        &lt;span style="color: #D0D0D0"&gt;S+=t,n&lt;/span&gt;
        &lt;span style="color: #6EBF26; font-weight: bold"&gt;while&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;t&amp;lt;t_max:&lt;/span&gt;
            &lt;span style="color: #6EBF26; font-weight: bold"&gt;if&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;rand()&amp;lt;p*dt:&lt;/span&gt;
                &lt;span style="color: #D0D0D0"&gt;n+=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;

            &lt;span style="color: #D0D0D0"&gt;t+=dt&lt;/span&gt;

            &lt;span style="color: #D0D0D0"&gt;S+=t,n&lt;/span&gt;

        &lt;span style="color: #D0D0D0"&gt;S_mat.append(S)&lt;/span&gt;

    &lt;span style="color: #6EBF26; font-weight: bold"&gt;return&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;S_mat&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;and&lt;/p&gt;
&lt;div class="highlight" style="background: #202020"&gt;&lt;pre style="line-height: 125%;"&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span style="color: #6EBF26; font-weight: bold"&gt;def&lt;/span&gt;&lt;span style="color: #666"&gt; &lt;/span&gt;&lt;span style="color: #71ADFF"&gt;dynamic_time&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;(N=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;20&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,n0=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,t_max=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1000&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,p=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0.02&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,dt=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;):&lt;/span&gt;
    &lt;span style="color: #D0D0D0"&gt;S_mat=[]&lt;/span&gt;
    &lt;span style="color: #6EBF26; font-weight: bold"&gt;for&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;_&lt;/span&gt; &lt;span style="color: #6EBF26; font-weight: bold"&gt;in&lt;/span&gt; &lt;span style="color: #2FBCCD"&gt;range&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;(N):&lt;/span&gt;
        &lt;span style="color: #D0D0D0"&gt;S=Storage()&lt;/span&gt;
        &lt;span style="color: #D0D0D0"&gt;t=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0&lt;/span&gt;
        &lt;span style="color: #D0D0D0"&gt;n=n0&lt;/span&gt;
        &lt;span style="color: #D0D0D0"&gt;S+=t,n&lt;/span&gt;
        &lt;span style="color: #6EBF26; font-weight: bold"&gt;while&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;t&amp;lt;t_max:&lt;/span&gt;
            &lt;span style="color: #D0D0D0"&gt;λ=p&lt;/span&gt;
            &lt;span style="color: #D0D0D0"&gt;t_next=np.random.exponential(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;/λ)&lt;/span&gt;

            &lt;span style="color: #D0D0D0"&gt;t=t+t_next&lt;/span&gt;
            &lt;span style="color: #D0D0D0"&gt;S+=t,n&lt;/span&gt;

            &lt;span style="color: #D0D0D0"&gt;n+=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;
            &lt;span style="color: #D0D0D0"&gt;S+=t,n&lt;/span&gt;


        &lt;span style="color: #D0D0D0"&gt;S_mat.append(S)&lt;/span&gt;

    &lt;span style="color: #6EBF26; font-weight: bold"&gt;return&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;S_mat&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;to get&lt;/p&gt;
&lt;div class="highlight" style="background: #202020"&gt;&lt;pre style="line-height: 125%;"&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span style="color: #D0D0D0"&gt;figure(figsize=(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;12&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;10&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;))&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;subplot(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;

&lt;span style="color: #6EBF26; font-weight: bold"&gt;for&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;S&lt;/span&gt; &lt;span style="color: #6EBF26; font-weight: bold"&gt;in&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;constant_time():&lt;/span&gt;
    &lt;span style="color: #D0D0D0"&gt;t,n=S.arrays()&lt;/span&gt;
    &lt;span style="color: #D0D0D0"&gt;plot(t,n,&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;b-o&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,alpha=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0.01&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;

&lt;span style="color: #D0D0D0"&gt;ylabel(&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;$n$&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;title(&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;Constant Time&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;xlim([&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1000&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;])&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;gca().set_xticklabels([]);&lt;/span&gt;


&lt;span style="color: #D0D0D0"&gt;subplot(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;

&lt;span style="color: #6EBF26; font-weight: bold"&gt;for&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;S&lt;/span&gt; &lt;span style="color: #6EBF26; font-weight: bold"&gt;in&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;dynamic_time():&lt;/span&gt;
    &lt;span style="color: #D0D0D0"&gt;t,n=S.arrays()&lt;/span&gt;
    &lt;span style="color: #D0D0D0"&gt;plot(t,n,&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;b-o&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,alpha=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0.1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;

&lt;span style="color: #D0D0D0"&gt;ylabel(&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;$n$&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;xlabel(&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;$t$&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;title(&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;Dynamic Time&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;xlim([&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1000&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img alt="Pasted image 20220106221326.png" src="https://bblais.github.io/images/Pasted image 20220106221326.png"&gt;&lt;/p&gt;
&lt;p&gt;Timing this, we get more than 10x faster with the dynamic time.  This would be more if the rates were lower. &lt;/p&gt;
&lt;div class="highlight" style="background: #202020"&gt;&lt;pre style="line-height: 125%;"&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span style="color: #D0D0D0"&gt;%timeit&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;S_mat=constant_time();&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;blockquote&gt;
&lt;p&gt;18.8 ms ± 614 µs per loop (mean ± std. dev. of 7 runs, 10 loops each)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class="highlight" style="background: #202020"&gt;&lt;pre style="line-height: 125%;"&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span style="color: #D0D0D0"&gt;%timeit&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;S_mat=dynamic_time();&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;blockquote&gt;
&lt;p&gt;1.39 ms ± 29.3 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="gillespie"&gt;Gillespie&lt;/h2&gt;
&lt;p&gt;We now can extend the problem to the next simplest case, where two types of events can happen, say a birth probability and a death probability.  This extension will have two added complexities from the previous example:
1. more than one type of event
2. the probabilities for those events, which determine the rates, depend on the variables and thus depend on time&lt;/p&gt;
&lt;p&gt;In the simple birth-death process we have,&lt;/p&gt;
&lt;div class="math"&gt;$$
\begin{aligned}
p_\text{birth}&amp;amp;=b\cdot n\\
p_\text{death}&amp;amp;=d\cdot n\\
\end{aligned}
$$&lt;/div&gt;
&lt;p&gt;
where &lt;span class="math"&gt;\(b\)&lt;/span&gt; and &lt;span class="math"&gt;\(d\)&lt;/span&gt; are the per-capita probability for a birth or death, respectively, and where a birth results in &lt;span class="math"&gt;\(n\rightarrow n+1\)&lt;/span&gt; and a death results in &lt;span class="math"&gt;\(n\rightarrow n-1\)&lt;/span&gt;.  The Gillespie algorithm proceeds in two steps
1. generate the next time (like above) for &lt;em&gt;some&lt;/em&gt; event using the sum of the rates of all of the possible events
2. randomly choose one of the possible events, weighted by their prospective rates -- faster processes chosen more often&lt;/p&gt;
&lt;p&gt;In code this could look like&lt;/p&gt;
&lt;div class="highlight" style="background: #202020"&gt;&lt;pre style="line-height: 125%;"&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span style="color: #D0D0D0"&gt;no=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;5&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;b=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0.03&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;d=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0.02&lt;/span&gt;
&lt;span style="color: #6EBF26; font-weight: bold"&gt;for&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;_&lt;/span&gt; &lt;span style="color: #6EBF26; font-weight: bold"&gt;in&lt;/span&gt; &lt;span style="color: #2FBCCD"&gt;range&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;20&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;):&lt;/span&gt;
    &lt;span style="color: #D0D0D0"&gt;S=Storage()&lt;/span&gt;

    &lt;span style="color: #D0D0D0"&gt;n=no&lt;/span&gt;
    &lt;span style="color: #D0D0D0"&gt;t=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0&lt;/span&gt;
    &lt;span style="color: #D0D0D0"&gt;S+=t,n&lt;/span&gt;
    &lt;span style="color: #D0D0D0"&gt;t_max=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;200&lt;/span&gt;
    &lt;span style="color: #6EBF26; font-weight: bold"&gt;while&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;t&amp;lt;t_max:&lt;/span&gt;
        &lt;span style="color: #D0D0D0"&gt;pb=b*n&lt;/span&gt;
        &lt;span style="color: #D0D0D0"&gt;pd=d*n&lt;/span&gt;

        &lt;span style="color: #D0D0D0"&gt;rates=[pb,pd]&lt;/span&gt;
        &lt;span style="color: #D0D0D0"&gt;total_rates=&lt;/span&gt;&lt;span style="color: #2FBCCD"&gt;sum&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;(rates)&lt;/span&gt;

        &lt;span style="color: #6EBF26; font-weight: bold"&gt;if&lt;/span&gt; &lt;span style="color: #6EBF26; font-weight: bold"&gt;not&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;total_rates:&lt;/span&gt;
            &lt;span style="color: #6EBF26; font-weight: bold"&gt;break&lt;/span&gt;
        &lt;span style="color: #D0D0D0"&gt;time_next&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;=&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;np.random.exponential(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;/&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;total_rates)&lt;/span&gt;
        &lt;span style="color: #D0D0D0"&gt;r=np.random.rand()*total_rates&lt;/span&gt;

        &lt;span style="color: #D0D0D0"&gt;t+=time_next&lt;/span&gt;
        &lt;span style="color: #D0D0D0"&gt;S+=t,n&lt;/span&gt;
        &lt;span style="color: #6EBF26; font-weight: bold"&gt;if&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;r&amp;lt;pb:&lt;/span&gt;
            &lt;span style="color: #D0D0D0"&gt;n+=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;
        &lt;span style="color: #6EBF26; font-weight: bold"&gt;else&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;:&lt;/span&gt;
            &lt;span style="color: #D0D0D0"&gt;n-=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;

        &lt;span style="color: #D0D0D0"&gt;S+=t,n&lt;/span&gt;

    &lt;span style="color: #D0D0D0"&gt;S+=t,n&lt;/span&gt;
    &lt;span style="color: #D0D0D0"&gt;t,n=S.arrays()&lt;/span&gt;
    &lt;span style="color: #D0D0D0"&gt;plot(t,n,&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;b.-&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,alpha=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0.1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;


&lt;span style="color: #D0D0D0"&gt;t=linspace(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,t_max,&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;100&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;plot(t,no*exp((b-d)*t),&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;r-&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;    
&lt;span style="color: #D0D0D0"&gt;xlabel(&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;time&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;ylabel(&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;$n$&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;xlim([&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,t_max])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img alt="Pasted image 20220107080030.png" src="https://bblais.github.io/images/Pasted image 20220107080030.png"&gt;&lt;/p&gt;
&lt;p&gt;for large N, this should look like the solution&lt;/p&gt;
&lt;div class="math"&gt;$$
\frac{dn}{dt}=b\cdot n - d\cdot n
$$&lt;/div&gt;
&lt;p&gt;
which will be exponential (population growth),
&lt;/p&gt;
&lt;div class="math"&gt;$$
n=n_o e^{(b-d)\cdot t}
$$&lt;/div&gt;
&lt;p&gt;
which you can see in the red.  In the small-&lt;span class="math"&gt;\(N\)&lt;/span&gt; case (like the one above, starting with &lt;span class="math"&gt;\(n=5\)&lt;/span&gt;, there is a lot of variation, but the &lt;em&gt;average&lt;/em&gt; is the exponential curve.  Changing &lt;span class="math"&gt;\(n_o=500\)&lt;/span&gt; we can see the variation reduces considerably.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Pasted image 20220107080819.png" src="https://bblais.github.io/images/Pasted image 20220107080819.png"&gt;&lt;/p&gt;
&lt;h2 id="gillespie-with-sir-model"&gt;Gillespie with SIR Model&lt;/h2&gt;
&lt;p&gt;As a final example we look at a probabilistic &lt;a href="https://en.wikipedia.org/wiki/Compartmental_models_in_epidemiology#The_SIR_model" rel="nofollow"&gt;SIR model&lt;/a&gt;.  In this model we have three sub-populations or compartments, &lt;span class="math"&gt;\(S\)&lt;/span&gt;, &lt;span class="math"&gt;\(I\)&lt;/span&gt;, and &lt;span class="math"&gt;\(R\)&lt;/span&gt; for Susceptible, Infected, and Recovered.  The Susceptible become infected at a rate of &lt;span class="math"&gt;\(\beta S I\)&lt;/span&gt; and the Infected recover at a rate of &lt;span class="math"&gt;\(\gamma I\)&lt;/span&gt;.  Another way to write this is as two possible events.&lt;/p&gt;
&lt;div class="math"&gt;$$
\begin{aligned}
S,I &amp;amp;\stackrel{\beta S I}{\longrightarrow} S-1, I+1\\
I,R &amp;amp;\stackrel{\gamma I}{\longrightarrow} I-1, R+1\\
\end{aligned}
$$&lt;/div&gt;
&lt;p&gt;
So, Gillespie follows by&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;generate the next time (like above) for &lt;em&gt;some&lt;/em&gt; event (e.g. one of the two above) using the sum of the rates of all of the possible events&lt;/li&gt;
&lt;li&gt;randomly choose one of the possible events, weighted by their prospective rates -- faster processes chosen more often&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight" style="background: #202020"&gt;&lt;pre style="line-height: 125%;"&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span style="color: #D0D0D0"&gt;number_of_sims=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;100&lt;/span&gt;

&lt;span style="color: #6EBF26; font-weight: bold"&gt;for&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;_&lt;/span&gt; &lt;span style="color: #6EBF26; font-weight: bold"&gt;in&lt;/span&gt; &lt;span style="color: #2FBCCD"&gt;range&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;(number_of_sims):&lt;/span&gt;

    &lt;span style="color: #D0D0D0"&gt;Io=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;
    &lt;span style="color: #D0D0D0"&gt;N=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;100&lt;/span&gt;
    &lt;span style="color: #D0D0D0"&gt;tmax=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;100&lt;/span&gt;


    &lt;span style="color: #D0D0D0"&gt;Io=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;
    &lt;span style="color: #D0D0D0"&gt;β=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;
    &lt;span style="color: #D0D0D0"&gt;γ=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0.5&lt;/span&gt;


    &lt;span style="color: #D0D0D0"&gt;t=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0.0&lt;/span&gt;
    &lt;span style="color: #D0D0D0"&gt;ni=Io&lt;/span&gt;
    &lt;span style="color: #D0D0D0"&gt;ns=N-ni&lt;/span&gt;
    &lt;span style="color: #D0D0D0"&gt;nr=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0&lt;/span&gt;

    &lt;span style="color: #D0D0D0"&gt;S=Storage()&lt;/span&gt;
    &lt;span style="color: #D0D0D0"&gt;S+=t,ns,ni,nr&lt;/span&gt;    

    &lt;span style="color: #D0D0D0"&gt;tw=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0.0&lt;/span&gt;
    &lt;span style="color: #6EBF26; font-weight: bold"&gt;while&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;(t&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;&amp;lt;&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;tmax):&lt;/span&gt;
        &lt;span style="color: #D0D0D0"&gt;w1=β*ns*ni/N&lt;/span&gt;  &lt;span style="color: #ABABAB; font-style: italic"&gt;# infect&lt;/span&gt;
        &lt;span style="color: #D0D0D0"&gt;w2=γ*ni&lt;/span&gt; &lt;span style="color: #ABABAB; font-style: italic"&gt;# recover&lt;/span&gt;
        &lt;span style="color: #D0D0D0"&gt;w=w1+w2&lt;/span&gt;    

        &lt;span style="color: #D0D0D0"&gt;tn=-log(rand())/w&lt;/span&gt;  &lt;span style="color: #ABABAB; font-style: italic"&gt;# when&amp;#39;s the next thing happening?&lt;/span&gt;
        &lt;span style="color: #D0D0D0"&gt;t=t+tn&lt;/span&gt;
        &lt;span style="color: #D0D0D0"&gt;r=rand()*w&lt;/span&gt;  &lt;span style="color: #ABABAB; font-style: italic"&gt;# which thing happened?&lt;/span&gt;
        &lt;span style="color: #6EBF26; font-weight: bold"&gt;if&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;(r&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;&amp;lt;&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;w1):&lt;/span&gt;
            &lt;span style="color: #D0D0D0"&gt;ns-=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;
            &lt;span style="color: #D0D0D0"&gt;ni+=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;
        &lt;span style="color: #6EBF26; font-weight: bold"&gt;else&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;:&lt;/span&gt; 
            &lt;span style="color: #D0D0D0"&gt;nr+=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;
            &lt;span style="color: #D0D0D0"&gt;ni-=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;


        &lt;span style="color: #D0D0D0"&gt;S+=t,ns,ni,nr&lt;/span&gt;

        &lt;span style="color: #6EBF26; font-weight: bold"&gt;if&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;ni==&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;:&lt;/span&gt;
            &lt;span style="color: #6EBF26; font-weight: bold"&gt;break&lt;/span&gt;


    &lt;span style="color: #D0D0D0"&gt;t,ns,ni,nr=S.arrays()&lt;/span&gt;

    &lt;span style="color: #D0D0D0"&gt;plot(t,ns,&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;b&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,alpha=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0.1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
    &lt;span style="color: #D0D0D0"&gt;plot(t,ni,&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;g&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,alpha=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0.1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
    &lt;span style="color: #D0D0D0"&gt;plot(t,nr,&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,alpha=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0.1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;    



&lt;span style="color: #ABABAB; font-style: italic"&gt;# these numbers taken from a pyndamics simulation, just for comparison&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;t,S,I,R=(array([&lt;/span&gt; &lt;span style="color: #51B2FD"&gt;0.&lt;/span&gt;        &lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;  &lt;span style="color: #51B2FD"&gt;1.57894737&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;  &lt;span style="color: #51B2FD"&gt;3.15789474&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;  &lt;span style="color: #51B2FD"&gt;4.73684211&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;  &lt;span style="color: #51B2FD"&gt;6.31578947&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;
         &lt;span style="color: #51B2FD"&gt;7.89473684&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;  &lt;span style="color: #51B2FD"&gt;9.47368421&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt; &lt;span style="color: #51B2FD"&gt;11.05263158&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt; &lt;span style="color: #51B2FD"&gt;12.63157895&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt; &lt;span style="color: #51B2FD"&gt;14.21052632&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;
        &lt;span style="color: #51B2FD"&gt;15.78947368&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt; &lt;span style="color: #51B2FD"&gt;17.36842105&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt; &lt;span style="color: #51B2FD"&gt;18.94736842&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt; &lt;span style="color: #51B2FD"&gt;20.52631579&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt; &lt;span style="color: #51B2FD"&gt;22.10526316&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;
        &lt;span style="color: #51B2FD"&gt;23.68421053&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt; &lt;span style="color: #51B2FD"&gt;25.26315789&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt; &lt;span style="color: #51B2FD"&gt;26.84210526&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt; &lt;span style="color: #51B2FD"&gt;28.42105263&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt; &lt;span style="color: #51B2FD"&gt;30.&lt;/span&gt;        &lt;span style="color: #D0D0D0"&gt;]),&lt;/span&gt;
         &lt;span style="color: #D0D0D0"&gt;array([&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;99.&lt;/span&gt;        &lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt; &lt;span style="color: #51B2FD"&gt;96.68233609&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt; &lt;span style="color: #51B2FD"&gt;92.04102645&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt; &lt;span style="color: #51B2FD"&gt;83.73584541&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt; &lt;span style="color: #51B2FD"&gt;71.42053096&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;
                &lt;span style="color: #51B2FD"&gt;57.24621795&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt; &lt;span style="color: #51B2FD"&gt;44.66960674&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt; &lt;span style="color: #51B2FD"&gt;35.51429297&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt; &lt;span style="color: #51B2FD"&gt;29.55644131&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt; &lt;span style="color: #51B2FD"&gt;25.85923582&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;
                &lt;span style="color: #51B2FD"&gt;23.59619256&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt; &lt;span style="color: #51B2FD"&gt;22.21121513&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt; &lt;span style="color: #51B2FD"&gt;21.36043856&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt; &lt;span style="color: #51B2FD"&gt;20.83578683&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt; &lt;span style="color: #51B2FD"&gt;20.51122022&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;
                &lt;span style="color: #51B2FD"&gt;20.31000289&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt; &lt;span style="color: #51B2FD"&gt;20.18506816&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt; &lt;span style="color: #51B2FD"&gt;20.10742367&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt; &lt;span style="color: #51B2FD"&gt;20.05914037&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt; &lt;span style="color: #51B2FD"&gt;20.02910249&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;]),&lt;/span&gt;
         &lt;span style="color: #D0D0D0"&gt;array([&lt;/span&gt; &lt;span style="color: #51B2FD"&gt;1.&lt;/span&gt;        &lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;  &lt;span style="color: #51B2FD"&gt;2.13320482&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;  &lt;span style="color: #51B2FD"&gt;4.31469633&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;  &lt;span style="color: #51B2FD"&gt;7.89149267&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt; &lt;span style="color: #51B2FD"&gt;12.25267231&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;
                &lt;span style="color: #51B2FD"&gt;15.36581863&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt; &lt;span style="color: #51B2FD"&gt;15.53893182&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt; &lt;span style="color: #51B2FD"&gt;13.22645672&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt; &lt;span style="color: #51B2FD"&gt;10.00259897&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;  &lt;span style="color: #51B2FD"&gt;7.01814482&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;
                 &lt;span style="color: #51B2FD"&gt;4.70207514&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;  &lt;span style="color: #51B2FD"&gt;3.0626549&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;  &lt;span style="color: #51B2FD"&gt;1.96059584&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;  &lt;span style="color: #51B2FD"&gt;1.2418213&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;  &lt;span style="color: #51B2FD"&gt;0.78139042&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;
                 &lt;span style="color: #51B2FD"&gt;0.48968045&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;  &lt;span style="color: #51B2FD"&gt;0.30609591&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;  &lt;span style="color: #51B2FD"&gt;0.19103806&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;  &lt;span style="color: #51B2FD"&gt;0.11911362&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;  &lt;span style="color: #51B2FD"&gt;0.07422209&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;]),&lt;/span&gt;
         &lt;span style="color: #D0D0D0"&gt;array([&lt;/span&gt; &lt;span style="color: #51B2FD"&gt;0.&lt;/span&gt;        &lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;  &lt;span style="color: #51B2FD"&gt;1.18445909&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;  &lt;span style="color: #51B2FD"&gt;3.64427722&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;  &lt;span style="color: #51B2FD"&gt;8.37266192&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt; &lt;span style="color: #51B2FD"&gt;16.32679674&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;
                &lt;span style="color: #51B2FD"&gt;27.38796342&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt; &lt;span style="color: #51B2FD"&gt;39.79146144&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt; &lt;span style="color: #51B2FD"&gt;51.25925031&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt; &lt;span style="color: #51B2FD"&gt;60.44095972&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt; &lt;span style="color: #51B2FD"&gt;67.12261936&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;
                &lt;span style="color: #51B2FD"&gt;71.7017323&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt; &lt;span style="color: #51B2FD"&gt;74.72612997&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt; &lt;span style="color: #51B2FD"&gt;76.6789656&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt; &lt;span style="color: #51B2FD"&gt;77.92239186&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt; &lt;span style="color: #51B2FD"&gt;78.70738935&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;
                &lt;span style="color: #51B2FD"&gt;79.20031666&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt; &lt;span style="color: #51B2FD"&gt;79.50883592&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt; &lt;span style="color: #51B2FD"&gt;79.70153827&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt; &lt;span style="color: #51B2FD"&gt;79.821746&lt;/span&gt;  &lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt; &lt;span style="color: #51B2FD"&gt;79.89667542&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;]))&lt;/span&gt;


&lt;span style="color: #ABABAB; font-style: italic"&gt;# these are here to get the legend with the right colors&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;plot(t,S,&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;b-&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,label=&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;S&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;plot(t,I,&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;g-&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,label=&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;I&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;plot(t,R,&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;r-&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,label=&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;R&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;    
&lt;span style="color: #D0D0D0"&gt;legend()&lt;/span&gt;

&lt;span style="color: #D0D0D0"&gt;xlabel(&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;time&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;ylabel(&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;number&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img alt="Pasted image 20220107082918.png" src="https://bblais.github.io/images/Pasted image 20220107082918.png"&gt;&lt;/p&gt;
&lt;p&gt;The comparison is made with a &lt;a href="https://bblais.github.io/pyndamics3/tutorial.zombies.html#SIR-Model" rel="nofollow"&gt;continuous version of the model using the pyndamics3 library&lt;/a&gt;.  We will see later that we can use &lt;a href="https://bblais.github.io/pyndamics3/" rel="nofollow"&gt;pyndamics3&lt;/a&gt; to do &lt;a href="https://bblais.github.io/pyndamics3/stochastic.html#Stochastic-SIR-Model" rel="nofollow"&gt;stochastic algorithms as well&lt;/a&gt;.&lt;/p&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &amp;lt; 768) ? "left" : align;
        indent = (screen.width &amp;lt; 768) ? "0em" : indent;
        linebreak = (screen.width &amp;lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    &lt;a href="http://mathjaxscript.id" rel="nofollow"&gt;mathjaxscript.id&lt;/a&gt; = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '&lt;a href="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';" rel="nofollow"&gt;https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';&lt;/a&gt;

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content><category term="science"/></entry><entry><title>Gravitational Attraction</title><link href="https://bblais.github.io/posts/2021/Apr/09/gravitational-attraction/" rel="alternate"/><published>2021-04-09T00:00:00-04:00</published><updated>2021-04-09T00:00:00-04:00</updated><author><name>Brian Blais</name></author><id>tag:bblais.github.io,2021-04-09:/posts/2021/Apr/09/gravitational-attraction/</id><summary type="html">&lt;p&gt;What would happen if two people out in space a few meters apart, abandoned by their spacecraft, decided to wait until gravity pulled them together?  My initial thought was that …&lt;/p&gt;</summary><content type="html">&lt;p&gt;What would happen if two people out in space a few meters apart, abandoned by their spacecraft, decided to wait until gravity pulled them together?  My initial thought was that it would take a really long time, longer than they would practically be able to wait.  The calculation (unless I've done something wrong) seems to indicate otherwise.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://bblais.github.io/images/two people.png" width=200 align=center&gt;&lt;/p&gt;
&lt;p&gt;My first approach, which is approximate, is to determine the resulting kinetic energy when they come together and assume (badly) that it was a constant acceleration to determine the time.  This will low-ball the time but be easy to calculate. My second approach is to numerically simulate the system in &lt;a href="https://github.com/bblais/pyndamics3" rel="nofollow"&gt;pyndamics3&lt;/a&gt;.  If I feel like it, I might do the integral later, but after the first approximation I like to look at things numerically (mostly for fun).&lt;/p&gt;
&lt;p&gt;Let's make the following assumptions:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class="math"&gt;\(m_1\)&lt;/span&gt; = &lt;span class="math"&gt;\(m_2\)&lt;/span&gt; = 100 kg&lt;/li&gt;
&lt;li&gt;&lt;span class="math"&gt;\(r_{\rm start}=3 {\rm m}\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;span class="math"&gt;\(r_{\rm end}=0.5 {\rm m}\)&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;then we set up the calculation&lt;/p&gt;
&lt;div class="math"&gt;$$
\begin{aligned}
-G \frac{m_1 m_2}{r_{\rm start}}  + 0 &amp;amp;= -G \frac{m_1 m_2}{r_{\rm end}} + \frac{1}{2} m_1 v^2 + \frac{1}{2} m_2 v^2  \\
 \frac{1}{2} (100 {\rm kg}+100 {\rm kg}) v^2 &amp;amp;= -6.7\times 10^{-11} \left[\frac{{\rm J}{\rm m}}{{\rm kg}^2}\right]\frac{100 {\rm kg} \cdot 100 {\rm kg}}{3 {\rm m}} - \left( -6.7\times 10^{-11} \left[\frac{{\rm J}{\rm m}}{{\rm kg}^2}\right]\frac{100 {\rm kg} \cdot 100 {\rm kg}}{0.5 {\rm m}}\right)
\end{aligned}
$$&lt;/div&gt;
&lt;div class="highlight" style="background: #202020"&gt;&lt;pre style="line-height: 125%;"&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span style="color: #D0D0D0"&gt;In&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;[&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;7&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;]:&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;G=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;6.7e-11&lt;/span&gt;

&lt;span style="color: #D0D0D0"&gt;In&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;[&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;8&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;]:&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;m1=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;100&lt;/span&gt;

&lt;span style="color: #D0D0D0"&gt;In&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;[&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;9&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;]:&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;m2=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;100&lt;/span&gt;

&lt;span style="color: #D0D0D0"&gt;In&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;[&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;10&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;]:&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;r_start=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;3&lt;/span&gt;

&lt;span style="color: #D0D0D0"&gt;In&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;[&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;11&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;]:&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;r_end=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0.5&lt;/span&gt;

&lt;span style="color: #D0D0D0"&gt;In&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;[&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;12&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;]:&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;-G*m1*m2/r_start-(-G*m1*m2/r_end)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;Out[&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;12&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;]:&lt;/span&gt; &lt;span style="color: #51B2FD"&gt;1.1166666666666668e-06&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class="math"&gt;$$
\begin{aligned}
\frac{1}{2} (100 {\rm kg}+100 {\rm kg}) v^2 &amp;amp;=&amp;amp; 1.12 \times 10^{-6} {\rm J} \\
v&amp;amp;=&amp;amp;1.1\times 10^{-4} {\rm m}/{\rm s} 
\end{aligned}
$$&lt;/div&gt;
&lt;div class="highlight" style="background: #202020"&gt;&lt;pre style="line-height: 125%;"&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span style="color: #D0D0D0"&gt;In&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;[&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;13&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;]:&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;v=sqrt(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1.12e-6&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;/(m1+m2))&lt;/span&gt;

&lt;span style="color: #D0D0D0"&gt;In&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;[&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;14&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;]:&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;v&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;Out[&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;14&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;]:&lt;/span&gt; &lt;span style="color: #51B2FD"&gt;0.00010583005244258362&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Assuming a constant acceleration, for each person to travel half of the 2.5 m distance separation, would be&lt;/p&gt;
&lt;div class="math"&gt;$$
\begin{aligned}
\frac{v_{\rm final}}{2} &amp;amp;=&amp;amp; \frac{2.5 {\rm m}}{t} \\
t&amp;amp;=&amp;amp; 45000 {\rm s} = 12 {\rm hr}
\end{aligned}
$$&lt;/div&gt;
&lt;p&gt;which is much shorter time than I was expecting!  &lt;/p&gt;
&lt;p&gt;Not being satisfied, I implemented it in [pyndamics3]&lt;/p&gt;
&lt;div class="highlight" style="background: #202020"&gt;&lt;pre style="line-height: 125%;"&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span style="color: #6EBF26; font-weight: bold"&gt;from&lt;/span&gt;&lt;span style="color: #666"&gt; &lt;/span&gt;&lt;span style="color: #71ADFF; text-decoration: underline"&gt;pyndamics3&lt;/span&gt;&lt;span style="color: #666"&gt; &lt;/span&gt;&lt;span style="color: #6EBF26; font-weight: bold"&gt;import&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;*&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;sim=Simulation()&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;sim.add(&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;quot;x1&amp;#39; = v1&amp;quot;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,-&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1.5&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,plot=&lt;/span&gt;&lt;span style="color: #6EBF26; font-weight: bold"&gt;True&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;sim.add(&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;quot;x2&amp;#39; = v2&amp;quot;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1.5&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,plot=&lt;/span&gt;&lt;span style="color: #6EBF26; font-weight: bold"&gt;True&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;sim.add(&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;quot;v1&amp;#39; = G*m1*m2/(x2-x1)**2/m1&amp;quot;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,plot=&lt;/span&gt;&lt;span style="color: #6EBF26; font-weight: bold"&gt;True&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;sim.add(&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;quot;v2&amp;#39; = -G*m1*m2/(x2-x1)**2/m2&amp;quot;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,plot=&lt;/span&gt;&lt;span style="color: #6EBF26; font-weight: bold"&gt;True&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;sim.params(G=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;6.7e-11&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,m1=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;100&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,m2=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;100&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;

&lt;span style="color: #D0D0D0"&gt;second=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;minute=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;60&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*second&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;hour=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;60&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*minute&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;day=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;24&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*hour&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;t=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;13&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*hour+&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;25&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*minute&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;sim.run(t)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src="https://bblais.github.io/images/x1x2.png" width=600 align=center&gt;&lt;/p&gt;
&lt;p&gt;which clearly shows them coming together in around 1/2 of a day, from their own gravity.  I guess I have to adjust my intuitions for such situations.&lt;/p&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &amp;lt; 768) ? "left" : align;
        indent = (screen.width &amp;lt; 768) ? "0em" : indent;
        linebreak = (screen.width &amp;lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    &lt;a href="http://mathjaxscript.id" rel="nofollow"&gt;mathjaxscript.id&lt;/a&gt; = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '&lt;a href="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';" rel="nofollow"&gt;https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';&lt;/a&gt;

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content><category term="science"/><category term="science"/></entry><entry><title>A Simple Physics Problem Gets Messy</title><link href="https://bblais.github.io/posts/2020/Aug/03/a-simple-physics-problem-gets-messy/" rel="alternate"/><published>2020-08-03T00:00:00-04:00</published><updated>2020-08-03T00:00:00-04:00</updated><author><name>Brian Blais</name></author><id>tag:bblais.github.io,2020-08-03:/posts/2020/Aug/03/a-simple-physics-problem-gets-messy/</id><summary type="html">&lt;p&gt;A physics problem from a practice AP test came to my attention, when my daughter was in AP physics this past spring.  I went over her solutions when she did …&lt;/p&gt;</summary><content type="html">&lt;p&gt;A physics problem from a practice AP test came to my attention, when my daughter was in AP physics this past spring.  I went over her solutions when she did the practice questions so that she would have another resource to explain the concepts involved.  Due the new format this year, adjusting to the COVID-19 restrictions, there were &lt;em&gt;only four such practice problems&lt;/em&gt; available to work from.  Although the four questions were generally pretty good, I thought, &lt;a href="https://youtu.be/L1oIsHMB1RQ?t=1751" rel="nofollow"&gt;the official solution&lt;/a&gt; to a quarter of one of the questions was simply incorrect. &lt;/p&gt;
&lt;p&gt;It's a good example of how assumptions affect any problem, how a simple problem can get messy quickly, and how one can use computation to explore even a messy version of a physics problem.  I was unable to solve the final part analytically because of an assumption &lt;a href="https://youtu.be/L1oIsHMB1RQ?t=1751" rel="nofollow"&gt;the official solution&lt;/a&gt; made that was not explicitly stated in the problem.  It turned out that this assumption was not physically reasonable, but was necessary in order to actually solve the problem.&lt;/p&gt;
&lt;p&gt;The introduction to the problem is given here:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;A student is given a spring that does NOT obey Hooke's Law. The student is told that the relationship between the magnitude of the force exerted by the spring and the magnitude of the spring's stretch or compression is given by the function &lt;span class="math"&gt;\(F = Bx^3\)&lt;/span&gt; . &lt;strong&gt;The student wishes to determine whether this is the correct relationship between &lt;span class="math"&gt;\(F\)&lt;/span&gt; and &lt;span class="math"&gt;\(x\)&lt;/span&gt; and, if it is, to determine the value of &lt;span class="math"&gt;\(B\)&lt;/span&gt;.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="https://bblais.github.io/images/AP20/car_table.png" width=400&gt;&lt;/p&gt;
&lt;p&gt;The student fixes the spring to a vertical wall just above a flat table, as shown above. The student also has a cart of known mass &lt;span class="math"&gt;\(M\)&lt;/span&gt; that has light wheels and frictionless bearings. The student also has access to a meterstick and a scientific calculator that can perform four functions, exponents and roots, but cannot perform curve fitting or analyze lists of data.&lt;/p&gt;
&lt;p&gt;(a) State the measurements that the student should make, and give each measurement a meaningful algebraic symbol.&lt;/p&gt;
&lt;p&gt;(b) Describe the procedure that the student should follow in order to make the measurements necessary to accomplish the student's purpose.&lt;/p&gt;
&lt;p&gt;(c) Explain how the student should use the measurements in order to accomplish the student's purpose. Explicitly explain how the relationship between &lt;span class="math"&gt;\(F\)&lt;/span&gt; and &lt;span class="math"&gt;\(x\)&lt;/span&gt; can be tested and the value of &lt;span class="math"&gt;\(B\)&lt;/span&gt; determined.&lt;/p&gt;
&lt;p&gt;(d) Suppose that the table is not level, so that the cart, upon becoming a projectile, has a sight upward launch angle. How would the true value of &lt;span class="math"&gt;\(B\)&lt;/span&gt; compare to the value calculated by a student following your procedure and data analysis outlined above?&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;The official solution to the questions is posted is here:  &lt;a href="https://youtu.be/L1oIsHMB1RQ?t=1751" rel="nofollow"&gt;https://youtu.be/L1oIsHMB1RQ?t=1751&lt;/a&gt;&lt;/p&gt;
&lt;h2 id="determining-b"&gt;Determining &lt;span class="math"&gt;\(B\)&lt;/span&gt;&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;(a) State the measurements that the student should make, and give each measurement a meaningful algebraic symbol.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;First I define the quantities, and derive expressions for the constants.  I really answer this part&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class="math"&gt;\(x_o\)&lt;/span&gt; is the compression length&lt;/li&gt;
&lt;li&gt;&lt;span class="math"&gt;\(M\)&lt;/span&gt; is the mass&lt;/li&gt;
&lt;li&gt;&lt;span class="math"&gt;\(v_o\)&lt;/span&gt; is the horizontal launch speed off the flat table&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="math"&gt;$$U = \int F(x) dx = \frac{B x_o^4}{4}$$&lt;/div&gt;
&lt;div class="math"&gt;$$
\begin{aligned}
\frac{B x_o^4}{4} &amp;amp;= \frac{1}{2} mv_o^2 \\
v_o^2 &amp;amp;= \frac{B x_o^4}{2 m} \\
v_o \cdot t &amp;amp;= R \\
h&amp;amp;= \frac{1}{2} g t^2 \\
t^2 &amp;amp;= \frac{2h}{g} = \frac{R^2}{v_o^2} \\
\frac{R^2 g}{h} &amp;amp;= \frac{B x_o^4}{4}\\
R^2 &amp;amp;= x_o^4\cdot \frac{B\cdot h}{4g}
\end{aligned}
$$&lt;/div&gt;
&lt;div class="math"&gt;$$
B = \frac{R^2 g m}{x_o^4 h}
$$&lt;/div&gt;
&lt;p&gt;So, varying &lt;span class="math"&gt;\(x_o\)&lt;/span&gt; and measuring the range, &lt;span class="math"&gt;\(R\)&lt;/span&gt;, we can determine &lt;span class="math"&gt;\(B\)&lt;/span&gt;.  &lt;/p&gt;
&lt;h2 id="from-data-to-b"&gt;From data to &lt;span class="math"&gt;\(B\)&lt;/span&gt;&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;(b) Describe the procedure that the student should follow in order to make the measurements necessary to accomplish the student's purpose.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Plotting &lt;span class="math"&gt;\(R^2\)&lt;/span&gt; vs &lt;span class="math"&gt;\(x_o^4\)&lt;/span&gt; the slope will be &lt;span class="math"&gt;\(B\cdot h/4g\)&lt;/span&gt;.  Or better yet, plot &lt;span class="math"&gt;\(\log(R)\)&lt;/span&gt; vs &lt;span class="math"&gt;\(\log(x_o)\)&lt;/span&gt;.  &lt;/p&gt;
&lt;div class="math"&gt;$$
\begin{aligned}
\frac{R^2 g}{h} &amp;amp;= \frac{B x_o^4}{4} \\
R^2 &amp;amp;= x_o^4\cdot \frac{B\cdot h}{4g} \\
2\log(R) &amp;amp;= 4\log(x_o) + \log\left(\frac{B\cdot h}{4g}\right)
\end{aligned}
$$&lt;/div&gt;
&lt;p&gt;so the intercept will be &lt;span class="math"&gt;\(\log\left(\frac{B\cdot h}{4g}\right)\)&lt;/span&gt;.&lt;/p&gt;
&lt;h2 id="verifyingdetermining-the-form-of-the-force"&gt;Verifying/Determining the form of the Force&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;(c) Explain how the student should use the measurements in order to accomplish the student's purpose. Explicitly explain how the relationship between &lt;span class="math"&gt;\(F\)&lt;/span&gt; and &lt;span class="math"&gt;\(x\)&lt;/span&gt; can be tested and the value of &lt;span class="math"&gt;\(B\)&lt;/span&gt; determined.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;The slope of the line from &lt;span class="math"&gt;\(\log(R)\)&lt;/span&gt; vs &lt;span class="math"&gt;\(\log(x_o)\)&lt;/span&gt; will determine the power of the spring energy function.  Slope of &lt;span class="math"&gt;\(4\)&lt;/span&gt; will confirm the &lt;span class="math"&gt;\(x^3\)&lt;/span&gt; form of the force.  &lt;/p&gt;
&lt;h2 id="the-ramp-and-the-official-incorrect-solution"&gt;The Ramp and the Official (Incorrect) Solution&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;(d) Suppose that the table is not level, so that the cart, upon becoming a projectile, has a sight upward launch angle. How would the true value of &lt;span class="math"&gt;\(B\)&lt;/span&gt; compare to the value calculated by a student following your procedure and data analysis outlined above?&lt;/p&gt;
&lt;p&gt;&lt;img src="https://bblais.github.io/images/AP20/car_table_ramp.png" width=400&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;This is where the official solution goes off the rails.   He states that,&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;If launch angle is a little bit up, the value of the range [&lt;span class="math"&gt;\(R\)&lt;/span&gt; in my notation, &lt;span class="math"&gt;\(D\)&lt;/span&gt; in theirs] will be a little bit farther than they ideally would have been, so if you get a farther distance &lt;span class="math"&gt;\(R\)&lt;/span&gt; than you should have gotten, then you would get a higher &lt;span class="math"&gt;\(B\)&lt;/span&gt;.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Hidden in this solution, but one not stated in the problem, is an assumption which we'll discuss later.  We continue our solution of the ramp projectile.  The range launched from a height &lt;span class="math"&gt;\(h\)&lt;/span&gt; at an angle &lt;span class="math"&gt;\(\theta\)&lt;/span&gt; is (&lt;a href="https://en.wikipedia.org/wiki/Range_of_a_projectile" rel="nofollow"&gt;https://en.wikipedia.org/wiki/Range_of_a_projectile&lt;/a&gt;),&lt;/p&gt;
&lt;div class="math"&gt;$$
R_1=\frac{v^2}{2g} \left(1+\sqrt{1+\frac{2gh}{v^2\sin^2(\theta)}}\right)\sin(2\theta)
$$&lt;/div&gt;
&lt;p&gt;
this form doesn't look much like the flat-table range, &lt;/p&gt;
&lt;div class="math"&gt;$$
\begin{aligned}
R_o^2 &amp;amp;= \frac{2 v_o^2 h}{g} \\
R_o &amp;amp;= v_o \cdot \sqrt{\frac{2h}{g}}
\end{aligned}
$$&lt;/div&gt;
&lt;p&gt;
but you can show that they are the same in the limit &lt;span class="math"&gt;\(\theta\rightarrow 0\)&lt;/span&gt;,&lt;/p&gt;
&lt;div class="math"&gt;$$
\begin{aligned}
R_1&amp;amp;=\frac{v^2}{2g} \left(1+\sqrt{1+\frac{2gh}{v^2\sin^2(\theta)}}\right)\sin(2\theta) \\
&amp;amp;\sim \frac{v^2}{2g} \left(1+\sqrt{1+\frac{2gh}{v^2 \theta^2}}\right)\cdot 2\theta \\
&amp;amp;\sim \frac{v^2}{2g} \left(\sqrt{\frac{2gh}{v^2 \theta^2}}\right)\cdot 2\theta \\
&amp;amp;=v \sqrt{\frac{2 h}{g}}
\end{aligned}
$$&lt;/div&gt;
&lt;p&gt;
which matches the form of &lt;span class="math"&gt;\(R_o\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;It's not obvious that &lt;span class="math"&gt;\(R_1\)&lt;/span&gt; is an increasing function of &lt;span class="math"&gt;\(\theta\)&lt;/span&gt;, as stated in the solution (e.g. angle goes up, the range goes up) but numerically it is easy to demonstrate,&lt;/p&gt;
&lt;div class="highlight" style="background: #202020"&gt;&lt;pre style="line-height: 125%;"&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span style="color: #D0D0D0"&gt;B=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;  &lt;span style="color: #ABABAB; font-style: italic"&gt;# true value&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;x0=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1.1&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;m=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0.01&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;h=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;20&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;g=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;10&lt;/span&gt;

&lt;span style="color: #D0D0D0"&gt;θ=linspace(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0.001&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;60&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;100&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;

&lt;span style="color: #D0D0D0"&gt;U=B*x0**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;4&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;/&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;4&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;KE=U&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;v=sqrt(KE*&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;/m)&lt;/span&gt;

&lt;span style="color: #D0D0D0"&gt;R0=sqrt(v**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*h/g)*ones(&lt;/span&gt;&lt;span style="color: #2FBCCD"&gt;len&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;(θ))&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;R1=v**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;/&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;/g*(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;+sqrt(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;+&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*g*h/v**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;/sin(radians(θ))**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;))*sin(radians(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*θ))&lt;/span&gt;

&lt;span style="color: #D0D0D0"&gt;θ_at_max=arcsin(sqrt(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)*v*sqrt(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;/(g*h&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;+&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;v**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;))/&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;θ_at_max2=arcsin(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;/sqrt(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)*&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;/sqrt(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;+&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*g*h*m/B/x0**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;4&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;))&lt;/span&gt;

&lt;span style="color: #D0D0D0"&gt;B_est0=R0**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*g*m/(x0**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;4&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*h)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;B_est1=R1**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*g*m/(x0**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;4&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*h)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight" style="background: #202020"&gt;&lt;pre style="line-height: 125%;"&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span style="color: #D0D0D0"&gt;figure(figsize=(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;16&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;6&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;))&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;subplot(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;plot(θ,R0,label=&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;No Ramp&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;plot(θ,R1,label=&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;With Ramp&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;

&lt;span style="color: #D0D0D0"&gt;vlines(degrees(θ_at_max),*ylim(),ls=&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;:&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;vlines(degrees(θ_at_max2),*ylim(),ls=&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;--&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,lw=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,color=&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;

&lt;span style="color: #D0D0D0"&gt;ylabel(&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;Range&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;xlabel(&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;Angle&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;legend()&lt;/span&gt;


&lt;span style="color: #D0D0D0"&gt;subplot(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;plot(θ,B_est0,label=&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;No Ramp&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;plot(θ,B_est1,label=&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;With Ramp&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;vlines(degrees(θ_at_max),*ylim(),ls=&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;:&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;ylabel(&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;$B$&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;xlabel(&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;Angle&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;legend()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img alt="png" src="https://bblais.github.io/images/AP20/output_9_1.png"&gt;&lt;/p&gt;
&lt;p&gt;As you can see, for small angle, the range increases with angle before decreasing again for steep angles.  So far, so good.  You wouldn't expect a student on a test to do the next parts, but I wasn't convinced that the assumption made in the solution held in all cases, or that there wasn't some range of parameters for which the simplistic "angle goes up, range goes up" would hold experimentally.  So, I continued the analysis in as much deatil as I could.&lt;/p&gt;
&lt;h3 id="maximum-angle"&gt;Maximum angle&lt;/h3&gt;
&lt;p&gt;What is shown in the plot is that above some critical angle, the range starts going down.  We expect that, because obviously if you had a ramp of &lt;span class="math"&gt;\(\theta=90^\circ\)&lt;/span&gt; you'd have no range.  But what if that critical angle was somehow small, like &lt;span class="math"&gt;\(2^\circ\)&lt;/span&gt;?  One might miss it experimentally if you were measuring, say, every &lt;span class="math"&gt;\(5^\circ\)&lt;/span&gt;.  But could this ever happen in this simple system?  Let's see.&lt;/p&gt;
&lt;p&gt;The critical angle that gives the maximum range is determined analytically from,&lt;/p&gt;
&lt;div class="highlight" style="background: #202020"&gt;&lt;pre style="line-height: 125%;"&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span style="color: #6EBF26; font-weight: bold"&gt;import&lt;/span&gt;&lt;span style="color: #666"&gt; &lt;/span&gt;&lt;span style="color: #71ADFF; text-decoration: underline"&gt;sympy&lt;/span&gt;&lt;span style="color: #666"&gt; &lt;/span&gt;&lt;span style="color: #6EBF26; font-weight: bold"&gt;as&lt;/span&gt;&lt;span style="color: #666"&gt; &lt;/span&gt;&lt;span style="color: #71ADFF; text-decoration: underline"&gt;sym&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;v,g,h,θ,x_o,B,m=sym.symbols(&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;quot;v g h θ x_o B m&amp;quot;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;R1=v**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;/&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;/g*(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;+sym.sqrt(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;+&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*g*h/v**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;/sym.sin(θ)**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;))*sym.sin(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*θ)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;display(R1)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;span class="math"&gt;\(\displaystyle \frac{v^{2} \left(\sqrt{\frac{2 g h}{v^{2} \sin^{2}{\left(θ \right)}} + 1} + 1\right) \sin{\left(2 θ \right)}}{2 g}\)&lt;/span&gt;&lt;/p&gt;
&lt;div class="highlight" style="background: #202020"&gt;&lt;pre style="line-height: 125%;"&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span style="color: #D0D0D0"&gt;df=sym.diff(R1,θ)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;soln=sym.solve(sym.simplify(df),θ)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;soln&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight" style="background: #202020"&gt;&lt;pre style="line-height: 125%;"&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;[-asin(sqrt(2)*v*sqrt(1/(g*h + v**2))/2),
 asin(sqrt(2)*v*sqrt(1/(g*h + v**2))/2)]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight" style="background: #202020"&gt;&lt;pre style="line-height: 125%;"&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span style="color: #D0D0D0"&gt;sin_θ_at_max=sym.sqrt(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)*v*sym.sqrt(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;/(g*h&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;+&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;v**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;))/&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;display(sin_θ_at_max)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;span class="math"&gt;\(\displaystyle \frac{\sqrt{2} v \sqrt{\frac{1}{g h + v^{2}}}}{2}\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;The slope near &lt;span class="math"&gt;\(\theta=0\)&lt;/span&gt; is positive, as can be derived by &lt;/p&gt;
&lt;div class="math"&gt;$$
\frac{dR_1}{d\theta}=- \frac{h \sin{\left(2 θ \right)} \cos{\left(θ \right)}}{\sqrt{\frac{2 g h}{v^{2} \sin^{2}{\left(θ \right)}} + 1} \sin^{3}{\left(θ \right)}} + \frac{v^{2} \left(\sqrt{\frac{2 g h}{v^{2} \sin^{2}{\left(θ \right)}} + 1} + 1\right) \cos{\left(2 θ \right)}}{g}
$$&lt;/div&gt;
&lt;p&gt;Applying small angle approximation for the trigonometric functions (e.g. &lt;span class="math"&gt;\(\sin\theta\sim \theta\)&lt;/span&gt;, &lt;span class="math"&gt;\(\cos\theta \sim 1\)&lt;/span&gt;) we get&lt;/p&gt;
&lt;div class="math"&gt;$$
\frac{dR_1}{d\theta}=\frac{v^{2}}{g} 
$$&lt;/div&gt;
&lt;p&gt;
which is positive.  Checking that this works numerically as well,&lt;/p&gt;
&lt;div class="highlight" style="background: #202020"&gt;&lt;pre style="line-height: 125%;"&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span style="color: #D0D0D0"&gt;B=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;  &lt;span style="color: #ABABAB; font-style: italic"&gt;# true value&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;x0=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1.1&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;m=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0.01&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;h=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;20&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;g=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;10&lt;/span&gt;

&lt;span style="color: #D0D0D0"&gt;θ=linspace(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0.001&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;60&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;100&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;

&lt;span style="color: #D0D0D0"&gt;U=B*x0**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;4&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;/&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;4&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;KE=U&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;v=sqrt(KE*&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;/m)&lt;/span&gt;

&lt;span style="color: #D0D0D0"&gt;R0=sqrt(v**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*h/g)*ones(&lt;/span&gt;&lt;span style="color: #2FBCCD"&gt;len&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;(θ))&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;R1=v**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;/&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;/g*(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;+sqrt(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;+&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*g*h/v**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;/sin(radians(θ))**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;))*sin(radians(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*θ))&lt;/span&gt;

&lt;span style="color: #D0D0D0"&gt;θ_at_max=arcsin(sqrt(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)*v*sqrt(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;/(g*h&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;+&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;v**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;))/&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;θ_at_max2=arcsin(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;/sqrt(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)*&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;/sqrt(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;+&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*g*h*m/B/x0**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;4&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;))&lt;/span&gt;

&lt;span style="color: #D0D0D0"&gt;B_est0=R0**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*g*m/(x0**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;4&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*h)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;B_est1=R1**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*g*m/(x0**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;4&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*h)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight" style="background: #202020"&gt;&lt;pre style="line-height: 125%;"&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span style="color: #D0D0D0"&gt;figure(figsize=(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;16&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;6&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;))&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;subplot(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;plot(θ,R0,label=&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;No Ramp&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;plot(θ,R1,label=&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;With Ramp&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;

&lt;span style="color: #D0D0D0"&gt;x=radians(θ[:&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;30&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;])&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;m=v**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;/g&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;b=R0[&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;]&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;y=m*x+b&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;plot(θ[:&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;30&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;],y,&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;c--&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,label=&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;Small Angle Approx&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;


&lt;span style="color: #D0D0D0"&gt;vlines(degrees(θ_at_max),*ylim(),ls=&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;:&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;vlines(degrees(θ_at_max2),*ylim(),ls=&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;--&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,lw=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,color=&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;

&lt;span style="color: #D0D0D0"&gt;ylabel(&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;Range&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;xlabel(&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;Angle&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;legend()&lt;/span&gt;


&lt;span style="color: #D0D0D0"&gt;subplot(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;plot(θ,B_est0,label=&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;No Ramp&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;plot(θ,B_est1,label=&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;With Ramp&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;vlines(degrees(θ_at_max),*ylim(),ls=&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;:&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;ylabel(&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;$B$&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;xlabel(&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;Angle&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;legend()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img alt="png" src="https://bblais.github.io/images/AP20/output_16_1.png"&gt;&lt;/p&gt;
&lt;p&gt;Given the symmetry, the point where the range starts decreasing with angle is at twice this angle.  Subsituting in the launch speed for the flat table, &lt;span class="math"&gt;\(v_o^2 = \frac{B x_o^4}{2 m}\)&lt;/span&gt;, we get something interesting.&lt;/p&gt;
&lt;div class="highlight" style="background: #202020"&gt;&lt;pre style="line-height: 125%;"&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span style="color: #D0D0D0"&gt;sin_θ_at_max.subs(v,sym.sqrt(B*x_o**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;4&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;/&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;/m)).simplify()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;span class="math"&gt;\(\displaystyle \frac{\sqrt{2} v \sqrt{\frac{1}{g h + v^{2}}}}{2}\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;yielding,&lt;/p&gt;
&lt;div class="math"&gt;$$
\sin \theta_{\rm max} = \frac{1}{\sqrt{2} \sqrt{1 + \frac{2 g h m}{B x_{o}^{4}}}}
$$&lt;/div&gt;
&lt;p&gt;the point here is that, while technically true that the range is an increasing function of &lt;span class="math"&gt;\(\theta\)&lt;/span&gt; for small &lt;span class="math"&gt;\(\theta\)&lt;/span&gt;, the turning point can be made arbitrarily small in certain parameter regions (e.g. small &lt;span class="math"&gt;\(B\)&lt;/span&gt;, small &lt;span class="math"&gt;\(x_o\)&lt;/span&gt;, large &lt;span class="math"&gt;\(m\)&lt;/span&gt;, etc...).  For instance,&lt;/p&gt;
&lt;div class="highlight" style="background: #202020"&gt;&lt;pre style="line-height: 125%;"&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span style="color: #D0D0D0"&gt;B=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;  &lt;span style="color: #ABABAB; font-style: italic"&gt;# true value&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;x0=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0.1&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;m=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0.01&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;h=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;20&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;g=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;10&lt;/span&gt;

&lt;span style="color: #D0D0D0"&gt;θ=linspace(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0.001&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;3&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;100&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;

&lt;span style="color: #D0D0D0"&gt;U=B*x0**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;4&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;/&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;4&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;KE=U&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;v=sqrt(KE*&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;/m)&lt;/span&gt;

&lt;span style="color: #D0D0D0"&gt;R0=sqrt(v**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*h/g)*ones(&lt;/span&gt;&lt;span style="color: #2FBCCD"&gt;len&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;(θ))&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;R1=v**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;/&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;/g*(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;+sqrt(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;+&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*g*h/v**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;/sin(radians(θ))**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;))*sin(radians(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*θ))&lt;/span&gt;

&lt;span style="color: #D0D0D0"&gt;θ_at_max=arcsin(sqrt(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)*v*sqrt(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;/(g*h&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;+&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;v**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;))/&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;θ_at_max2=arcsin(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;/sqrt(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)*&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;/sqrt(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;+&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*g*h*m/B/x0**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;4&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;))&lt;/span&gt;

&lt;span style="color: #D0D0D0"&gt;B_est0=R0**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*g*m/(x0**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;4&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*h)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;B_est1=R1**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*g*m/(x0**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;4&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*h)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight" style="background: #202020"&gt;&lt;pre style="line-height: 125%;"&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span style="color: #D0D0D0"&gt;figure(figsize=(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;16&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;6&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;))&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;subplot(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;plot(θ,R0,label=&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;No Ramp&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;plot(θ,R1,label=&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;With Ramp&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;

&lt;span style="color: #D0D0D0"&gt;x=radians(θ[:&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;30&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;])&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;m=v**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;/g&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;b=R0[&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;]&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;y=m*x+b&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;plot(θ[:&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;30&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;],y,&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;c--&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,label=&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;Small Angle Approx&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;


&lt;span style="color: #D0D0D0"&gt;vlines(degrees(θ_at_max),*ylim(),ls=&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;:&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;vlines(degrees(θ_at_max2),*ylim(),ls=&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;--&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,lw=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,color=&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;

&lt;span style="color: #D0D0D0"&gt;ylabel(&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;Range&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;xlabel(&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;Angle&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;legend()&lt;/span&gt;


&lt;span style="color: #D0D0D0"&gt;subplot(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;plot(θ,B_est0,label=&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;No Ramp&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;plot(θ,B_est1,label=&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;With Ramp&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;vlines(degrees(θ_at_max),*ylim(),ls=&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;:&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;ylabel(&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;$B$&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;xlabel(&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;Angle&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;legend()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img alt="png" src="https://bblais.github.io/images/AP20/output_22_1.png"&gt;&lt;/p&gt;
&lt;p&gt;So the claim that "range increases with angle" could be missed experimentally if the turning point is smaller than the ramp angle. To the person making the measurement, the range would &lt;em&gt;decrease&lt;/em&gt; with angle.  Still, technically, that claim is true...assuming the same launch speed. &lt;/p&gt;
&lt;h2 id="the-primary-assumption"&gt;The primary assumption&lt;/h2&gt;
&lt;p&gt;This brings us to the real problem with the given solution: &lt;strong&gt;the launch speed for the ramp case is not the same as the flat case&lt;/strong&gt;.  The spring gives the same amount to the kinetic energy, but it does so by &lt;em&gt;having the block move up the ramp&lt;/em&gt; as the spring expands.  Thus, the total kinetic energy of the block upon launch depends on the angle,&lt;/p&gt;
&lt;div class="math"&gt;$$
\begin{aligned}
U&amp;amp;= \frac{B x_o^4}{4} \\
{\rm KE}_{\rm flat} &amp;amp;= U \\
{\rm KE}_{\rm ramp} &amp;amp;= U - mgx_o\sin(\theta) 
\end{aligned}
$$&lt;/div&gt;
&lt;p&gt;This leads to a range equation like the one above for &lt;span class="math"&gt;\(R_1\)&lt;/span&gt;, but with an angle-dependent speed.  We'll call this range &lt;span class="math"&gt;\(R_2\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;(&lt;a href="https://en.wikipedia.org/wiki/Range_of_a_projectile" rel="nofollow"&gt;https://en.wikipedia.org/wiki/Range_of_a_projectile&lt;/a&gt;),&lt;/p&gt;
&lt;div class="math"&gt;$$
\begin{aligned}
R_1&amp;amp;=\frac{v^2}{2g} \left(1+\sqrt{1+\frac{2gh}{v^2\sin^2(\theta)}}\right)\sin(2\theta)\\
R_2&amp;amp;=\frac{v_o^2-2 g x_o\sin \theta}{2g} \left(1+\sqrt{1+\frac{2gh}{\left(v_o^2-2 g x_o\sin \theta\right)\sin^2(\theta)}}\right)\sin(2\theta)
\end{aligned}
$$&lt;/div&gt;
&lt;p&gt;which is a whole lot messier, and the slope is difficult to attain analytically.  Numerically however, it is easy to see the effect.  Depending on the parameters, &lt;strong&gt;the range could increase or decrease with angle&lt;/strong&gt;. &lt;/p&gt;
&lt;p&gt;Here's an example with increasing with angle.&lt;/p&gt;
&lt;div class="highlight" style="background: #202020"&gt;&lt;pre style="line-height: 125%;"&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span style="color: #D0D0D0"&gt;B=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;  &lt;span style="color: #ABABAB; font-style: italic"&gt;# true value&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;x0=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1.1&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;m=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0.01&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;h=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;20&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;g=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;10&lt;/span&gt;

&lt;span style="color: #D0D0D0"&gt;θ=linspace(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0.001&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;60&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;100&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;

&lt;span style="color: #D0D0D0"&gt;U=B*x0**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;4&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;/&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;4&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;KE=U&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;v=sqrt(KE*&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;/m)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;v_o=v&lt;/span&gt;

&lt;span style="color: #D0D0D0"&gt;R0=sqrt(v**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*h/g)*ones(&lt;/span&gt;&lt;span style="color: #2FBCCD"&gt;len&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;(θ))&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;R1=v**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;/&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;/g*(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;+sqrt(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;+&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*g*h/v**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;/sin(radians(θ))**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;))*sin(radians(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*θ))&lt;/span&gt;

&lt;span style="color: #D0D0D0"&gt;θ_at_max=arcsin(sqrt(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)*v*sqrt(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;/(g*h&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;+&lt;/span&gt; &lt;span style="color: #D0D0D0"&gt;v**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;))/&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;

&lt;span style="color: #D0D0D0"&gt;KE=U-m*g*x0*sin(radians(θ))&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;v=sqrt(KE*&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;/m)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;R2=v**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;/&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;/g*(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;+sqrt(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;+&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*g*h/v**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;/sin(radians(θ))**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;))*sin(radians(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*θ))&lt;/span&gt;




&lt;span style="color: #D0D0D0"&gt;B_est0=R0**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*g*m/(x0**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;4&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*h)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;B_est1=R1**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*g*m/(x0**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;4&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*h)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;B_est2=R2**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*g*m/(x0**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;4&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*h)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight" style="background: #202020"&gt;&lt;pre style="line-height: 125%;"&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span style="color: #D0D0D0"&gt;figure(figsize=(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;16&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;6&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;))&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;subplot(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;plot(θ,R0,label=&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;No Ramp&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;plot(θ,R1,label=&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;With Ramp no speed reduction&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;plot(θ,R2,label=&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;With Ramp with speed reduction&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;


&lt;span style="color: #D0D0D0"&gt;vlines(degrees(θ_at_max),*ylim(),ls=&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;:&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;ylabel(&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;Range&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;xlabel(&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;Angle&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;legend()&lt;/span&gt;


&lt;span style="color: #D0D0D0"&gt;subplot(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;plot(θ,B_est0,label=&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;No Ramp&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;plot(θ,B_est1,label=&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;With Ramp no speed reduction&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;plot(θ,B_est2,label=&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;With Ramp with speed reduction&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;vlines(degrees(θ_at_max),*ylim(),ls=&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;:&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;ylabel(&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;$B$&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;xlabel(&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;Angle&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;legend()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img alt="png" src="https://bblais.github.io/images/AP20/output_26_1.png"&gt;&lt;/p&gt;
&lt;p&gt;Here's an example with decreasing with angle.&lt;/p&gt;
&lt;div class="highlight" style="background: #202020"&gt;&lt;pre style="line-height: 125%;"&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span style="color: #D0D0D0"&gt;B=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;  &lt;span style="color: #ABABAB; font-style: italic"&gt;# true value&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;x0=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;.4&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;m=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0.01&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;h=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;20&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;g=&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;10&lt;/span&gt;

&lt;span style="color: #D0D0D0"&gt;θ=linspace(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;0.001&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;10&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;100&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;

&lt;span style="color: #D0D0D0"&gt;U=B*x0**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;4&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;/&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;4&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;KE=U&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;v=sqrt(KE*&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;/m)&lt;/span&gt;

&lt;span style="color: #D0D0D0"&gt;R0=sqrt(v**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*h/g)*ones(&lt;/span&gt;&lt;span style="color: #2FBCCD"&gt;len&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;(θ))&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;R1=v**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;/&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;/g*(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;+sqrt(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;+&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*g*h/v**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;/sin(radians(θ))**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;))*sin(radians(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*θ))&lt;/span&gt;


&lt;span style="color: #D0D0D0"&gt;KE=U-m*g*x0*sin(radians(θ))&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;v=sqrt(KE*&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;/m)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;R2=v**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;/&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;/g*(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;+sqrt(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;+&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*g*h/v**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;/sin(radians(θ))**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;))*sin(radians(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*θ))&lt;/span&gt;

&lt;span style="color: #D0D0D0"&gt;B_est0=R0**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*g*m/(x0**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;4&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*h)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;B_est1=R1**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*g*m/(x0**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;4&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*h)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;B_est2=R2**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*g*m/(x0**&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;4&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;*h)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight" style="background: #202020"&gt;&lt;pre style="line-height: 125%;"&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span style="color: #D0D0D0"&gt;figure(figsize=(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;16&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;6&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;))&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;subplot(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;plot(θ,R0,label=&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;No Ramp&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;plot(θ,R1,label=&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;With Ramp no speed reduction&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;plot(θ,R2,label=&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;With Ramp with speed reduction&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;


&lt;span style="color: #D0D0D0"&gt;ylabel(&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;Range&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;xlabel(&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;Angle&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;legend()&lt;/span&gt;


&lt;span style="color: #D0D0D0"&gt;subplot(&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;1&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;,&lt;/span&gt;&lt;span style="color: #51B2FD"&gt;2&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;plot(θ,B_est0,label=&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;No Ramp&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;plot(θ,B_est1,label=&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;With Ramp no speed reduction&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;plot(θ,B_est2,label=&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;With Ramp with speed reduction&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;ylabel(&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;$B$&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;xlabel(&lt;/span&gt;&lt;span style="color: #ED9D13"&gt;&amp;#39;Angle&amp;#39;&lt;/span&gt;&lt;span style="color: #D0D0D0"&gt;)&lt;/span&gt;
&lt;span style="color: #D0D0D0"&gt;legend()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img alt="png" src="https://bblais.github.io/images/AP20/output_29_1.png"&gt;&lt;/p&gt;
&lt;h2 id="conclusions"&gt;Conclusions&lt;/h2&gt;
&lt;p&gt;This problem was a very nice problem for the AP test until the last section.  A hidden assumption -- that the launch speed is unaffected by the ramp -- would have made it much better and avoided any possible complications.  However it's not a great assumption given the way the table and block are set up -- there is definitely a gravitational component to energy picked up along the ramp.  Without this simplifying assumption the effect is much more complicated. &lt;/p&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &amp;lt; 768) ? "left" : align;
        indent = (screen.width &amp;lt; 768) ? "0em" : indent;
        linebreak = (screen.width &amp;lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    &lt;a href="http://mathjaxscript.id" rel="nofollow"&gt;mathjaxscript.id&lt;/a&gt; = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '&lt;a href="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';" rel="nofollow"&gt;https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';&lt;/a&gt;

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content><category term="science"/><category term="science"/></entry><entry><title>10 dogmas of science dismantled</title><link href="https://bblais.github.io/posts/2018/Jun/18/10-dogmas-of-science-dismantled/" rel="alternate"/><published>2018-06-18T00:00:00-04:00</published><updated>2018-06-18T00:00:00-04:00</updated><author><name>Brian Blais</name></author><id>tag:bblais.github.io,2018-06-18:/posts/2018/Jun/18/10-dogmas-of-science-dismantled/</id><summary type="html">&lt;p&gt;In  his &lt;a href="https://www.youtube.com/watch?v=1TerTgDEgUE&amp;amp;t=583s" rel="nofollow"&gt;talk about the limitations of science&lt;/a&gt;, Rupert Sheldrake lists the "10 dogmas of modern science" (also listed here in text  &lt;a href="http://wariscrime.com/new/the-ten-dogmas-of-modern-science/" rel="nofollow"&gt;http://wariscrime.com/new/the-ten-dogmas-of-modern-science/&lt;/a&gt;).  They are:&lt;/p&gt;
&lt;blockquote&gt;
&lt;ol&gt;
&lt;li&gt;Everything …&lt;/li&gt;&lt;/ol&gt;&lt;/blockquote&gt;</summary><content type="html">&lt;p&gt;In  his &lt;a href="https://www.youtube.com/watch?v=1TerTgDEgUE&amp;amp;t=583s" rel="nofollow"&gt;talk about the limitations of science&lt;/a&gt;, Rupert Sheldrake lists the "10 dogmas of modern science" (also listed here in text  &lt;a href="http://wariscrime.com/new/the-ten-dogmas-of-modern-science/" rel="nofollow"&gt;http://wariscrime.com/new/the-ten-dogmas-of-modern-science/&lt;/a&gt;).  They are:&lt;/p&gt;
&lt;blockquote&gt;
&lt;ol&gt;
&lt;li&gt;Everything is essentially mechanical. Dogs, for example, are complex mechanisms, rather than living organisms with goals of their own. Even people are machines, ‘lumbering robots’, in Richard Dawkins’s vivid phrase, with brains that are like genetically programmed computers.&lt;/li&gt;
&lt;li&gt;All matter is unconscious. It has no inner life or subjectivity or point of view. Even human consciousness is an illusion produced by the material activities of brains.&lt;/li&gt;
&lt;li&gt;The total amount of matter and energy is always the same (with the exception of the Big Bang, when all the matter and energy of the universe suddenly appeared).&lt;/li&gt;
&lt;li&gt;The laws of nature are fixed. They are the same today as they were at the beginning, and they will stay the same for ever.&lt;/li&gt;
&lt;li&gt;Nature is purposeless, and evolution has no goal or direction.&lt;/li&gt;
&lt;li&gt;All biological inheritance is material, carried in the genetic material, DNA, and in other material structures.&lt;/li&gt;
&lt;li&gt;Minds are inside heads and are nothing but the activities of brains. When you look at a tree, the image of the tree you are seeing is not ‘out there’, where it seems to be, but inside your brain.&lt;/li&gt;
&lt;li&gt;Memories are stored as material traces in brains and are wiped out at death.&lt;/li&gt;
&lt;li&gt;Unexplained phenomena like telepathy are illusory.&lt;/li&gt;
&lt;li&gt;Mechanistic medicine is the only kind that really works.&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;p&gt;These are presented as dogmas, unquestioned by scientists and taken for granted.  Many of these are demonstrably false or misleading.  When he states (1) that animals and people "are complex mechanisms, rather than living organisms with goals of their own", this is an either-or fallacy.  They could be &lt;em&gt;both&lt;/em&gt; mechanisms and agents.  It could be that we use different vocabulary on different scales - I don't describe baseball in terms of quantum mechanics, even though I am confident that all the components of baseball is governed by quantum mechanics.  &lt;/p&gt;
&lt;p&gt;Sheldrake lists a number of things which are poorly understood, for which there is a growing list of research, the conclusions of which are not taken dogmatically.  Similarly, there are a number of things in the list where research has been done, and the current perspective (not dogma!) has been arrived at because there has been no evidence to support the alternatives that Sheldrake is implying.   Examples of these include (2) "All matter is unconscious", (8) "Memories are stored as material traces", (5) "evolution has no goal", (7) "Minds are inside heads".&lt;/p&gt;
&lt;p&gt;With (3), although energy is conserved (in a closed system) and matter is a subset of energy, it is not believed that the Big Bang &lt;em&gt;produced&lt;/em&gt; energy.  Rather, if the universe came from nothing then the total energy of the universe must be zero - which it empirically seems to be.  If the universe did not come from nothing, but came out of a universe-producing process then the energy didn’t “suddenly appear” as Sheldrake suggests.&lt;/p&gt;
&lt;p&gt;As to (4), the so-called fixed laws of Nature are a theory - which explains and is consistent with a huge variety of observations.  Thus, we are &lt;em&gt;confident&lt;/em&gt; in this particular theory.  It is possible, though, that the laws to change - and that would be measurable.  It is not taken as a dogma.&lt;/p&gt;
&lt;p&gt;Point (9) "Unexplained phenomena like telepathy are illusory" is misleading, given its incompleteness.  It seems that, given &lt;em&gt;years&lt;/em&gt; of observation, telepathy is in fact illusory.  However, there are many unexplained phenomena that are not illusory, e.g. dark matter, the placebo effect, etc...&lt;/p&gt;
&lt;p&gt;In every one of these cases, scientists don't hold these as &lt;em&gt;dogmas&lt;/em&gt;.  If you have evidence, then present it!  If it turns out that you can demonstrate telepathy, that would be fantastic - but everyone who has tried so far has not been able to demonstrate it.  It may be that the universe has purpose, and perhaps it is possible to differentiate a process with a purpose from one without in certain circumstances, but the person making the claim of the extra “purpose” must be the one to bear the burden of proof. &lt;/p&gt;
&lt;p&gt;I think it is easier for Sheldrake to accuse someone of a dogmatic view rather than do the hard work of actually convincing them with evidence.  Just because I disagree with you doesn't mean that I am dogmatically holding to my view - you just haven't done your homework. &lt;/p&gt;</content><category term="science"/><category term="science"/></entry><entry><title>Physics Lab Ideas - Structure or No?</title><link href="https://bblais.github.io/posts/2018/Feb/26/physics-lab-ideas-structure-or-no/" rel="alternate"/><published>2018-02-26T00:00:00-05:00</published><updated>2018-02-26T00:00:00-05:00</updated><author><name>Brian Blais</name></author><id>tag:bblais.github.io,2018-02-26:/posts/2018/Feb/26/physics-lab-ideas-structure-or-no/</id><summary type="html">&lt;p&gt;Over the years I have taught introductory physics labs and I have seen that most “canned” labs offer very little to the student in the form of learning.  I summarize …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Over the years I have taught introductory physics labs and I have seen that most “canned” labs offer very little to the student in the form of learning.  I summarize them as “here is something known quite well, and you are going to measure it badly”.  Labs measuring the acceleration due to gravity, &lt;span class="math"&gt;\(g\)&lt;/span&gt;, falls into that category.  How do you improve these sorts of labs?  I have a few ideas.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;choose problems where the answer isn’t known or known well&lt;/li&gt;
&lt;li&gt;push the limit of a particular simple case into the area where the simple case breaks down&lt;/li&gt;
&lt;li&gt;have the students design the lab themselves to answer a question&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;So, for the case of the acceleration due to gravity, put it as a model comparison problem:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Model 1 = objects fall with a constant &lt;em&gt;speed&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;Model 2 = objects fall with a constant &lt;em&gt;acceleration&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Then you give objects to the students such as pennies, packing peanuts, coffee filters, marbles, etc…  Some objects might be best explained with Model 2 while others with Model 1.  Neither model may describe some perfectly.  How can you tell?  Having the students design the resulting tests makes the laboratory experience a lot more interesting.  I’ll add a selfish note that it makes the labs more interesting &lt;em&gt;for the instructor&lt;/em&gt; as well.&lt;/p&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &amp;lt; 768) ? "left" : align;
        indent = (screen.width &amp;lt; 768) ? "0em" : indent;
        linebreak = (screen.width &amp;lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    &lt;a href="http://mathjaxscript.id" rel="nofollow"&gt;mathjaxscript.id&lt;/a&gt; = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '&lt;a href="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';" rel="nofollow"&gt;https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';&lt;/a&gt;

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content><category term="science"/></entry><entry><title>Sea Slug Brains</title><link href="https://bblais.github.io/posts/2018/Feb/07/sea-slug-brains/" rel="alternate"/><published>2018-02-07T00:00:00-05:00</published><updated>2018-02-07T00:00:00-05:00</updated><author><name>Brian Blais</name></author><id>tag:bblais.github.io,2018-02-07:/posts/2018/Feb/07/sea-slug-brains/</id><summary type="html">&lt;p&gt;I learned a somewhat disturbing fact about sea squirts recently - once they find their permanent home &lt;a href="https://www.psychologytoday.com/blog/choke/201207/how-humans-learn-lessons-the-sea-squirt" rel="nofollow"&gt;they eat their own brain&lt;/a&gt; because they don’t need it anymore - their brain …&lt;/p&gt;</summary><content type="html">&lt;p&gt;I learned a somewhat disturbing fact about sea squirts recently - once they find their permanent home &lt;a href="https://www.psychologytoday.com/blog/choke/201207/how-humans-learn-lessons-the-sea-squirt" rel="nofollow"&gt;they eat their own brain&lt;/a&gt; because they don’t need it anymore - their brain becomes a resource-heavy extraneous organ.  Yikes!  The article continues to explore the idea of how “Our body and mind are tightly connected. The body is an important part of the learning process.”, a concept which is not stressed enough.  &lt;/p&gt;</content><category term="science"/></entry><entry><title>I'm not a Denier, I'm a Skeptic</title><link href="https://bblais.github.io/posts/2018/Jan/11/im-not-a-denier-im-a-skeptic/" rel="alternate"/><published>2018-01-11T00:00:00-05:00</published><updated>2018-01-11T00:00:00-05:00</updated><author><name>Brian Blais</name></author><id>tag:bblais.github.io,2018-01-11:/posts/2018/Jan/11/im-not-a-denier-im-a-skeptic/</id><summary type="html">&lt;p&gt;In this tumultuous time, it is important to not demonize people who disagree with you.  It is also important to recognize that people can have nuanced views on complex subjects …&lt;/p&gt;</summary><content type="html">&lt;p&gt;In this tumultuous time, it is important to not demonize people who disagree with you.  It is also important to recognize that people can have nuanced views on complex subjects. Calling someone a denier when they have such views is not constructive.  For example, from &lt;a href="http://judithcurry.com/2015/04/28/making-nonsense-of-climate-denial/" rel="nofollow"&gt;"Making (non)sense of climate denial"&lt;/a&gt; we have:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Scientists agree that surface temperatures have increased since 1880, humans are adding carbon dioxide to the atmosphere, and carbon dioxide and other greenhouse gases have a warming effect on the planet. However there is considerable disagreement about the most consequential issues:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Whether the warming since 1950 has been dominated by human causes&lt;/li&gt;
&lt;li&gt;How much the planet will warm in the 21st century&lt;/li&gt;
&lt;li&gt;Whether warming is ‘dangerous’&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;This seems pretty reasonable to me, and is basically the view that I have.  I have seen a lot of overblown attribution to climate (e.g. polar bears, more frequent hurricanes, more intense tornadoes, etc...).  On the other hand, I've heard some ridiculous anti-climate change statements (e.g. it's cold outside now in New England therefore no climate change; people couldn't possible be influential enough to change the climate).  &lt;/p&gt;
&lt;p&gt;We must be vigilant to explore each claim, evaluate it on its own, and come closer to the truth which may indeed be messy.  We need to be open to messy, nuanced positions.&lt;/p&gt;</content><category term="science"/></entry><entry><title>Art, Scientific Reductionism, and the New Neuroscience</title><link href="https://bblais.github.io/posts/2018/Jan/10/art-scientific-reductionism-and-the-new-neuroscience/" rel="alternate"/><published>2018-01-10T00:00:00-05:00</published><updated>2018-01-10T00:00:00-05:00</updated><author><name>Brian Blais</name></author><id>tag:bblais.github.io,2018-01-10:/posts/2018/Jan/10/art-scientific-reductionism-and-the-new-neuroscience/</id><summary type="html">&lt;h2 id="introduction"&gt;Introduction&lt;/h2&gt;
&lt;p&gt;In an &lt;a href="http://chronicle.com/article/How-Art-Reveals-the-Limits-of/232821/?cid=cr&amp;amp;utm_source=cr&amp;amp;utm_medium=en" rel="nofollow"&gt;article in the Chronicle of Higher Education&lt;/a&gt;, Alva Noë challenges the neuroscience paradigm, summarized as&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;The momentous proposition is this: Every thought, feeling, experience, impression, value, argument …&lt;/p&gt;&lt;/blockquote&gt;</summary><content type="html">&lt;h2 id="introduction"&gt;Introduction&lt;/h2&gt;
&lt;p&gt;In an &lt;a href="http://chronicle.com/article/How-Art-Reveals-the-Limits-of/232821/?cid=cr&amp;amp;utm_source=cr&amp;amp;utm_medium=en" rel="nofollow"&gt;article in the Chronicle of Higher Education&lt;/a&gt;, Alva Noë challenges the neuroscience paradigm, summarized as&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;The momentous proposition is this: Every thought, feeling, experience, impression, value, argument, emotion, attitude, inclination, belief, desire, and ambition is in your brain. We may not know how the brain manages this feat, but, so it is said, we are beginning to understand. And this new knowledge — of how the organization of bits of matter inside your head can be your personality, thoughts, understanding, wonderings, religious or sexual impulses — is surely among the most exciting and important in all of science, or so it is claimed.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;He believes art doesn't follow this model,&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;But a work of art, like the meaningful world around us, is not a mere stimulus. And we work hard — we look, we ask, we think, we collaborate — to bring art and world into focus for consciousness.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;He then critiques neuroscience as claiming that the picture and the object are the same,&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;The equivalency of a picture and what it depicts, however, is deeply implausible.[...]You may see a woman in the statuette. But you are not in the same state you would be in if you were in the presence of an actual woman. &lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;He continues exploring aesthetics, point out&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Aesthetic responses are not fixed data points but are rather like positions staked out in a conversation, continuing in our day, our lives, and in the historical time of our culture. Aesthetic responses are cultivated and nourished, and they are also challenged. Encountering a work of art is more like an evening with a friend, or an afternoon at work, than it is like the transient relishing of a flavor. Aesthetic responses are also sometimes questions that the art poses to us rather than definitive answers; they are beginnings, opportunities, not data points.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;In summary,&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Aesthetic responses, then, are not symptoms or reactions or stable quantities. They are actions. They are modes of participation. They are moments of conversation. There is nothing about which we can even ask: What are its neural correlates? And moreover, to look for neural correlates is already to have turned away from what deserves to be called aesthetic experience, for it is to have turned away from art and toward mere synaptic goings-on inside us.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="response"&gt;Response&lt;/h2&gt;
&lt;p&gt;As I was reading this article, I was immediately struck by how limiting the author sees neuroscience.  The "equivalency of a picture and what it depicts" is pretty silly - there is obviously a distinction both in and outside of the brain.  We can tell the difference between a picture of an object and the object itself because internally there is a neural model which represents the object in all of the features we've experienced about the object.  This neural model is activated when a sufficient number of its properties are activated - which may be associations from other areas.  Seeing the 2D representation of a sculpture results in the neural model becoming active; seeing the 3D object as we walk around it also results in the neural model becoming active, perhaps even more strongly and with more associations.&lt;/p&gt;
&lt;p&gt;The article also fails to include multiple modalities.  It is true that you can get visual responses from art, but even going to a museum to see paintings provides a more rich neural representation including smells, alternate visual angles, connections to stories about the piece, etc...  Even within the paradigm of neural models, nothing in the experience of art is inconsistent.&lt;/p&gt;
&lt;p&gt;The idea of aesthetic responses as "actions" and "moments of conversation" is entirely consistent with the language of neural correlates.  It's just an admission that most of our experience is an interplay between internal models and actions driven by the brain's representation in such a complex fashion that we can't easily summarize it.  Scientifically, we can choose to isolate certain modalities - vision alone, for example - in order to understand pieces of it.  The scientists aren't assuming that's all there is, but it may be all that can be described at this time - at least in quantitative detail.&lt;/p&gt;
&lt;p&gt;It would be a very interesting research project to see how the visual system is modified by learning in other areas.  Do people actually &lt;em&gt;see&lt;/em&gt; art differently when they know the context or is the visual system doing the same thing in both cases but the increased aesthetic response comes from the interaction of multiple brain areas?  Far from eliminating the language of neuroscience, we should wholeheartedly embrace it.&lt;/p&gt;</content><category term="science"/></entry></feed>